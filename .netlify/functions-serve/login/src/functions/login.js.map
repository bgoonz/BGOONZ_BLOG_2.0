{
  "version": 3,
  "sources": ["../../workspace/BGOONZ_BLOG_2.0/functions/login.ts", "../../workspace/BGOONZ_BLOG_2.0/node_modules/@cloudflare/pages-plugin-cloudflare-access/api/index.ts"],
  "sourceRoot": "/tmp/tmp-3101-JQhVVPA0j9My",
  "sourcesContent": ["import { generateLoginURL } from \"@cloudflare/pages-plugin-cloudflare-access/api\";\n\nexport const onRequest = () => {\n  const loginURL = generateLoginURL({\n    redirectURL: \"https://example.com/greet\",\n    domain: \"https://test.cloudflareaccess.com\",\n    aud: \"4714c1358e65fe4b408ad6d432a5f878f08194bdb4752441fd56faefa9b2b6f2\",\n  });\n\n  return new Response(null, {\n    status: 302,\n    headers: { Location: loginURL },\n  });\n};", "import { Identity } from \"..\";\n\nexport const getIdentity = async ({\n  jwt,\n  domain,\n}: {\n  jwt: string;\n  domain: string;\n}): Promise<undefined | Identity> => {\n  const identityURL = new URL(\"/cdn-cgi/access/get-identity\", domain);\n  const response = await fetch(identityURL.toString(), {\n    headers: { Cookie: `CF_Authorization=${jwt}` },\n  });\n  if (response.ok) return await response.json();\n};\n\nexport const generateLoginURL = ({\n  redirectURL: redirectURLInit,\n  domain,\n  aud,\n}: {\n  redirectURL: string | URL;\n  domain: string;\n  aud: string;\n}): string => {\n  const redirectURL =\n    typeof redirectURLInit === \"string\"\n      ? new URL(redirectURLInit)\n      : redirectURLInit;\n  const { hostname } = redirectURL;\n  const loginPathname = `/cdn-cgi/access/login/${hostname}?`;\n  const searchParams = new URLSearchParams({\n    kid: aud,\n    redirect_url: redirectURL.pathname + redirectURL.search,\n  });\n  return new URL(loginPathname + searchParams.toString(), domain).toString();\n};\n\nexport const generateLogoutURL = ({ domain }: { domain: string }) =>\n  new URL(`/cdn-cgi/access/logout`, domain).toString();\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;;;ACgBO,IAAM,mBAAmB,CAAC;AAAA,EAC/B,aAAa;AAAA,EACb;AAAA,EACA;AAAA,MAKY;AACZ,QAAM,cACJ,OAAO,oBAAoB,WACvB,IAAI,IAAI,eAAe,IACvB;AACN,QAAM,EAAE,aAAa;AACrB,QAAM,gBAAgB,yBAAyB;AAC/C,QAAM,eAAe,IAAI,gBAAgB;AAAA,IACvC,KAAK;AAAA,IACL,cAAc,YAAY,WAAW,YAAY;AAAA,EACnD,CAAC;AACD,SAAO,IAAI,IAAI,gBAAgB,aAAa,SAAS,GAAG,MAAM,EAAE,SAAS;AAC3E;;;ADlCO,IAAM,YAAY,MAAM;AAC7B,QAAM,WAAW,iBAAiB;AAAA,IAChC,aAAa;AAAA,IACb,QAAQ;AAAA,IACR,KAAK;AAAA,EACP,CAAC;AAED,SAAO,IAAI,SAAS,MAAM;AAAA,IACxB,QAAQ;AAAA,IACR,SAAS,EAAE,UAAU,SAAS;AAAA,EAChC,CAAC;AACH;",
  "names": []
}
