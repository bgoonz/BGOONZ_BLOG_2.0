<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>PostgreSQL In 43 Commands Or Less</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">PostgreSQL In 43 Commands Or Less</h1>
</header>
<section data-field="subtitle" class="p-summary">
In database jargon, PostgreSQL uses a client/server model. A PostgreSQL session consists of the following cooperating processes (programs):
</section>
<section data-field="body" class="e-content">
<section name="4447" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="242d" id="242d" class="graf graf--h3 graf--leading graf--title">PostgreSQL In 43 Commands Or Less</h3><h4 name="d15b" id="d15b" class="graf graf--h4 graf-after--h3 graf--subtitle">In database jargon, PostgreSQL uses a client/server model. A PostgreSQL session consists of the following cooperating processes (programs):</h4><div name="df05" id="df05" class="graf graf--mixtapeEmbed graf-after--h4"><a href="https://bryanguner.medium.com/a-list-of-all-of-my-articles-to-link-to-future-posts-1f6f88ebdf5b" data-href="https://bryanguner.medium.com/a-list-of-all-of-my-articles-to-link-to-future-posts-1f6f88ebdf5b" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://bryanguner.medium.com/a-list-of-all-of-my-articles-to-link-to-future-posts-1f6f88ebdf5b"><strong class="markup--strong markup--mixtapeEmbed-strong">ALLOFMYOTHERARTICLES</strong><br>bryanguner.medium.com</a><a href="https://bryanguner.medium.com/a-list-of-all-of-my-articles-to-link-to-future-posts-1f6f88ebdf5b" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="b0e65722872b5407711fed22574106a2"></a></div><figure name="1d00" id="1d00" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="0*zo9j6MVAbEaxG8Be.gif" data-width="880" data-height="452" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*zo9j6MVAbEaxG8Be.gif"></figure><ul class="postList"><li name="d5d8" id="d5d8" class="graf graf--li graf-after--figure">A server process, which manages the database files, accepts connections to the database from client applications, and performs database actions on behalf of the clients. The database server program is called <code class="markup--code markup--li-code">postgres</code>.</li><li name="91d1" id="91d1" class="graf graf--li graf-after--li">The user’s client (frontend) application that wants to perform database operations. Client applications can be very diverse in nature: a client could be a text-oriented tool, a graphical application, a web server that accesses the database to display web pages, or a specialized database maintenance tool. Some client applications are supplied with the PostgreSQL distribution; most are developed by users.</li></ul><p name="487f" id="487f" class="graf graf--p graf-after--li">As is typical of client/server applications, the client and the server can be on different hosts. In that case they communicate over a TCP/IP network connection. You should keep this in mind, because the files that can be accessed on a client machine might not be accessible (or might only be accessible using a different file name) on the database server machine.</p><p name="5008" id="5008" class="graf graf--p graf-after--p">The PostgreSQL server can handle multiple concurrent connections from clients. To achieve this it starts (“forks”) a new process for each connection. From that point on, the client and the new server process communicate without intervention by the original <code class="markup--code markup--p-code">postgres</code> process. Thus, the master server process is always running, waiting for client connections, whereas client and associated server processes come and go. (All of this is of course invisible to the user. We only mention it here for completeness.)</p><h3 name="dd43" id="dd43" class="graf graf--h3 graf-after--p">What is SQL?</h3><p name="b538" id="b538" class="graf graf--p graf-after--h3">SQL is short for Structured Query Language. Originally, it used to be called SEQUEL (Structured English Query Language) and was used for storing and manipulating data in databases. Today SQL is used to perform all types of data operations in relational database management systems (RDBMS).</p><p name="09f2" id="09f2" class="graf graf--p graf-after--p">SQL is a powerful language where we can perform a wide range of operations:</p><ul class="postList"><li name="7f0b" id="7f0b" class="graf graf--li graf-after--p">execute queries</li><li name="d14a" id="d14a" class="graf graf--li graf-after--li">fetch data</li><li name="5389" id="5389" class="graf graf--li graf-after--li">insert, update, and delete records in a database (DML operations)</li><li name="f62e" id="f62e" class="graf graf--li graf-after--li">create new objects in a database (DDL operations)</li><li name="d790" id="d790" class="graf graf--li graf-after--li">set permissions on tables, procedures, functions, and views</li><li name="ebab" id="ebab" class="graf graf--li graf-after--li">and much, much more...</li></ul><p name="b4c0" id="b4c0" class="graf graf--p graf-after--li">Data is absolutely everywhere. When you visited this web page, you generated data. When you took a note of your to-dos for the day in your reminders, you generated data.</p><p name="8a33" id="8a33" class="graf graf--p graf-after--p">All of this data needs to go somewhere! That’s where databases come in. Databases store information in a structured way so that it is accessible by <a href="https://computersciencehero.com/" data-href="https://computersciencehero.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">computer programs</a>. Programmers use a tool called Structured Query Language (SQL) to access and manipulate databases.</p><p name="5415" id="5415" class="graf graf--p graf-after--p">In this guide, we’re going to provide a brief overview of SQL to help you level up your skills! Without further ado, let’s get started!</p><h3 name="535e" id="535e" class="graf graf--h3 graf-after--p">More On SQL?</h3><p name="188d" id="188d" class="graf graf--p graf-after--h3">SQL was invented in the early 1970s by the IBM researchers Donald Chamberlin and Raymond Boyce. The technology may be old but it’s still a crucial part of interacting with databases.</p><p name="f961" id="f961" class="graf graf--p graf-after--p">SQL is used to retrieve data from databases, insert records into a database, update a database, and to control the permissions in a database.</p><p name="6329" id="6329" class="graf graf--p graf-after--p">SQL is used with Relational Database Management Systems, or RDBMS. These are databases which are broken up into tables. Each table consists of a list of columns and rows. Tables can be linked together by creating primary and foreign keys between the tables.</p><p name="6c4e" id="6c4e" class="graf graf--p graf-after--p"><a href="https://careerkarma.com/careers/data-science/" data-href="https://careerkarma.com/careers/data-science/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Data scientists</a>, <a href="https://careerkarma.com/careers/database-administration/" data-href="https://careerkarma.com/careers/database-administration/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">database administrators</a>, <a href="https://studydatascience.org/how-to-become-data-analyst/" data-href="https://studydatascience.org/how-to-become-data-analyst/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">data analysts</a>, <a href="https://studydatascience.org/how-to-become-business-analyst/" data-href="https://studydatascience.org/how-to-become-business-analyst/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">business analysts</a> and <a href="https://careerkarma.com/careers/web-development/" data-href="https://careerkarma.com/careers/web-development/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">back-end web developers</a> are several of the many types of technologists who use databases in their work.</p><figure name="9940" id="9940" class="graf graf--figure graf--iframe graf-after--p"><iframe src="https://docs.google.com/presentation/embed?id=1RwXpp725DvM0f2MiPxBfYYTT5yXf8WoSlIoQKYJqVeg&amp;size=l" width="700" height="559" frameborder="0" scrolling="no"></iframe></figure><h3 name="7944" id="7944" class="graf graf--h3 graf-after--figure">Here’s a guide on how to get setup with PSQL:</h3><div name="d3a7" id="d3a7" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://bryanguner.medium.com/postgresql-setup-for-windows-wsl-ubuntu-801672ab7089" data-href="https://bryanguner.medium.com/postgresql-setup-for-windows-wsl-ubuntu-801672ab7089" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://bryanguner.medium.com/postgresql-setup-for-windows-wsl-ubuntu-801672ab7089"><strong class="markup--strong markup--mixtapeEmbed-strong">PostgreSQL Setup For Windows &amp; WSL/Ubuntu</strong><br><em class="markup--em markup--mixtapeEmbed-em">If you follow this guide to a tee… you will install PostgreSQL itself on your Windows installation. Then, you will…</em>bryanguner.medium.com</a><a href="https://bryanguner.medium.com/postgresql-setup-for-windows-wsl-ubuntu-801672ab7089" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="598c0b38b1352d871e15fff172ed360b" data-thumbnail-img-id="1*um8fm6FDTYYOXZrLudddpg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*um8fm6FDTYYOXZrLudddpg.png);"></a></div><h3 name="4e56" id="4e56" class="graf graf--h3 graf-after--mixtapeEmbed">Here’s a Cheatsheet I made:</h3><div name="929a" id="929a" class="graf graf--mixtapeEmbed graf-after--h3 graf--trailing"><a href="https://medium.com/codex/postgresql-cheat-sheet-718b813d3e31" data-href="https://medium.com/codex/postgresql-cheat-sheet-718b813d3e31" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/codex/postgresql-cheat-sheet-718b813d3e31"><strong class="markup--strong markup--mixtapeEmbed-strong">Postgresql Cheat Sheet</strong><br><em class="markup--em markup--mixtapeEmbed-em">PostgreSQL commands</em>medium.com</a><a href="https://medium.com/codex/postgresql-cheat-sheet-718b813d3e31" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="b992d39560764dae490b5180d382e76d" data-thumbnail-img-id="1*kgzq5NoL5ejBGvuZ4qLDaQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*kgzq5NoL5ejBGvuZ4qLDaQ.png);"></a></div></div></div></section><section name="d89a" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="d5c7" id="d5c7" class="graf graf--figure graf--iframe graf--leading"><script src="https://gist.github.com/bgoonz/983f0b6627f2aa7f256c9538b16861ed.js"></script></figure><h3 name="4dc8" id="4dc8" class="graf graf--h3 graf-after--figure">Inserting Data into a Database</h3><h3 name="bffc" id="bffc" class="graf graf--h3 graf-after--h3">Create a Table</h3><p name="384d" id="384d" class="graf graf--p graf-after--h3">The <a href="https://www.google.com/url?sa=t&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwijn6yqgePqAhV0oVwKHZnUD60QFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-create-table%2F&amp;usg=AOvVaw1vlxV4UV8ve5miYhGsDVaB" data-href="https://www.google.com/url?sa=t&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwijn6yqgePqAhV0oVwKHZnUD60QFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-create-table%2F&amp;usg=AOvVaw1vlxV4UV8ve5miYhGsDVaB" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CREATE TABLE</a> statement creates a new table in a database. You can use this command to specify what columns should appear in a database and the types of those columns.</p><h3 name="09e2" id="09e2" class="graf graf--h3 graf-after--p">Insert a Record</h3><p name="47b8" id="47b8" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-insert/" data-href="https://careerkarma.com/blog/sql-insert/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">INSERT INTO</a> statement inserts a new row into a database. Depending on the structure of a table, this statement can be used to insert some or all the values into a record.</p><h3 name="e227" id="e227" class="graf graf--h3 graf-after--p">Selecting Data from a Database</h3><h3 name="f073" id="f073" class="graf graf--h3 graf-after--h3">Selecting Data</h3><p name="6c06" id="6c06" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-select/" data-href="https://careerkarma.com/blog/sql-select/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SELECT statement</a> selects data from one or more tables. It can be used to retrieve all the rows in a table or only rows that meet a set of conditions. You can filter out what columns will be returned by the SELECT statement.</p><h3 name="2687" id="2687" class="graf graf--h3 graf-after--p">Where Statement</h3><p name="9d5e" id="9d5e" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-where/" data-href="https://careerkarma.com/blog/sql-where/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">WHERE</a> statement allows you to select a record based on a condition.</p><p name="e015" id="e015" class="graf graf--p graf-after--p">For instance, you could select all of the names in an Employees table that start with the letter “B”. You could select all the people in an Employees table who have worked for a business for at least four years.</p><h3 name="2612" id="2612" class="graf graf--h3 graf-after--p">Ordering Data</h3><p name="60c5" id="60c5" class="graf graf--p graf-after--h3">The <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi-54GUguPqAhXTT8AKHbnqC6EQFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-order-by%2F&amp;usg=AOvVaw0jds79ITS9idNt8V0HyXDz" data-href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwi-54GUguPqAhXTT8AKHbnqC6EQFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-order-by%2F&amp;usg=AOvVaw0jds79ITS9idNt8V0HyXDz" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">ORDER BY</a> clause sorts data by a particular column name. It can be used to sort data in either ascending or descending order.</p><p name="d039" id="d039" class="graf graf--p graf-after--p">You could sort a list of employees in ascending order based on the day they were hired. You could sort a list of coffee products by their prices in descending order.</p><h3 name="dd33" id="dd33" class="graf graf--h3 graf-after--p">Limiting Data</h3><p name="a8ee" id="a8ee" class="graf graf--p graf-after--h3">SQL databases can contain a lot of records. The <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjorsD7gePqAhXLiFwKHUj5DakQFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-limit%2F&amp;usg=AOvVaw2_D44T151S6h475cDfrhmu" data-href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjorsD7gePqAhXLiFwKHUj5DakQFjAAegQIBBAB&amp;url=https%3A%2F%2Fcareerkarma.com%2Fblog%2Fsql-limit%2F&amp;usg=AOvVaw2_D44T151S6h475cDfrhmu" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LIMIT clause</a> allows you to limit how many rows are returned by a query. For instance, you could return only the first five responses from a particular query.</p><h3 name="301c" id="301c" class="graf graf--h3 graf-after--p">Query Values Using Between</h3><p name="00b4" id="00b4" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-between/" data-href="https://careerkarma.com/blog/sql-between/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">BETWEEN</a> operator allows you to select records where a column value is within a particular range. For instance, you could use BETWEEN to retrieve a list of employees who work at a business and who earn between $20,000 and $30,000. You could use BETWEEN to retrieve a list of all the coffees at a cafe which cost between $2.00 and $2.50.</p><h3 name="393c" id="393c" class="graf graf--h3 graf-after--p">Updating a Database</h3><p name="2ed7" id="2ed7" class="graf graf--p graf-after--h3">Updating a database allows you to modify the information you have already stored, and you can do so by doing the following:</p><h3 name="743b" id="743b" class="graf graf--h3 graf-after--p">Updating Records</h3><p name="1cbf" id="1cbf" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-update/" data-href="https://careerkarma.com/blog/sql-update/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">UPDATE</a> statement amends the contents of a table. This statement will change all the values in a database that meet a particular condition or set of conditions. You can use a WHERE statement to select which values should be updated.</p><h3 name="2755" id="2755" class="graf graf--h3 graf-after--p">Deleting Records</h3><p name="35d5" id="35d5" class="graf graf--p graf-after--h3">The <a href="https://careerkarma.com/blog/sql-delete-row/" data-href="https://careerkarma.com/blog/sql-delete-row/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">DELETE</a> statement removes one or more rows from a table. By default, this command deletes all the records in a table. The DELETE statement is usually used with a WHERE statement so that only particular records are deleted.</p><p name="0c59" id="0c59" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">The SQL ALTER TABLE statement adds, changes, or removes a column in a table. This statement lets you modify a table after it has been created, even if the table stores records.</em></p><p name="5574" id="5574" class="graf graf--p graf-after--p">You may decide that you need to make a change to an SQL table. For instance, you may want to rename a column or add a new column to the table. These changes are all possible with the SQL ALTER TABLE command.</p><figure name="bae6" id="bae6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*s5UbiqN0qkySgA_a5bcXOw.png" data-width="960" data-height="540" src="https://cdn-images-1.medium.com/max/800/1*s5UbiqN0qkySgA_a5bcXOw.png"></figure><figure name="bdc8" id="bdc8" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*ZDx9fNK6yfyLkv_JmPMD8A.jpeg" data-width="960" data-height="540" src="https://cdn-images-1.medium.com/max/800/1*ZDx9fNK6yfyLkv_JmPMD8A.jpeg"></figure><figure name="d210" id="d210" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*K7Ch-fS6Wr5Lps5g0-oGVQ.png" data-width="960" data-height="540" src="https://cdn-images-1.medium.com/max/800/1*K7Ch-fS6Wr5Lps5g0-oGVQ.png"></figure><figure name="d712" id="d712" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*VVOVwGNPaiDVe79DzI9H9Q.png" data-width="960" data-height="540" src="https://cdn-images-1.medium.com/max/800/1*VVOVwGNPaiDVe79DzI9H9Q.png"></figure><h3 name="f8db" id="f8db" class="graf graf--h3 graf-after--figure">SQL ALTER TABLE</h3><p name="fa57" id="fa57" class="graf graf--p graf-after--h3">The ALTER TABLE command allows you to change an existing table by:</p><ul class="postList"><li name="c60b" id="c60b" class="graf graf--li graf-after--p">Adding a column.</li><li name="c841" id="c841" class="graf graf--li graf-after--li">Adding a constraint.</li><li name="028a" id="028a" class="graf graf--li graf-after--li">Removing a column.</li><li name="c667" id="c667" class="graf graf--li graf-after--li">Changing a data type.</li><li name="64bf" id="64bf" class="graf graf--li graf-after--li">Renaming a column.</li></ul><p name="6e2f" id="6e2f" class="graf graf--p graf-after--li"><em class="markup--em markup--p-em">There is no SQL ADD COLUMN statement. To add a column to an SQL table, you must use the ALTER TABLE ADD syntax. ALTER TABLE lets you add, delete, or modify columns in a table.</em></p><p name="205f" id="205f" class="graf graf--p graf-after--p">After you have created a table in <em class="markup--em markup--p-em">SQL</em>, you may realize that you forgot to add in a specific column that you need. For example, say you may have created a database to store a list of suppliers. Maybe you forgot to include a field to store the category of goods the supplier offers.</p><p name="b25f" id="b25f" class="graf graf--p graf-after--p">In these situations, you can use the <em class="markup--em markup--p-em">SQL ALTER TABLE</em> statement to amend an existing table. This statement allows you to add a column, change a column, or delete a column.</p><p name="1896" id="1896" class="graf graf--p graf-after--p">Below is an <em class="markup--em markup--p-em">SQL</em> command that will create an employee database that stores three columns. This database stores name of an employee, their title, and the branch for which they work.</p><pre name="d4c1" id="d4c1" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> employees (<br>	name VARCHAR(50) <strong class="markup--strong markup--pre-strong">NOT</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>,<br>	title VARCHAR(75) <strong class="markup--strong markup--pre-strong">NOT</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>,<br>	branch VARCHAR(25) <strong class="markup--strong markup--pre-strong">NOT</strong> <strong class="markup--strong markup--pre-strong">NULL</strong><br>);</pre><p name="72fc" id="72fc" class="graf graf--p graf-after--pre">But what if we’ve forgotten to add a column? Say we need to add a column that states whether an employee is on probation. That’s where the <em class="markup--em markup--p-em">ALTER TABLE</em> statement comes in.</p><h3 name="a7d4" id="a7d4" class="graf graf--h3 graf-after--p">SQL Add Column</h3><p name="db2a" id="db2a" class="graf graf--p graf-after--h3">To perform an SQL add column operation, use the ALTER TABLE ADD command. This command alters a table and adds in a column with the specified data type. Using this command, you can add a column to a table after you have created the table.</p><h3 name="1854" id="1854" class="graf graf--h3 graf-after--p">SQL UNION:</h3><p name="ce0b" id="ce0b" class="graf graf--p graf-after--h3">When you’re querying a database, you may want to combine the result of two or more <code class="markup--code markup--p-code">SELECT</code> statements. For example, you may want to get a list of the cities in which your customers are based, and the cities in which your business has branches. You could run two queries to achieve this goal, but you may want to have a result in one query.</p><p name="4a8b" id="4a8b" class="graf graf--p graf-after--p">That’s where the <code class="markup--code markup--p-code">SQL UNION</code> operator comes in. The <code class="markup--code markup--p-code">UNION</code> clause can be used to combine the results of two or more <code class="markup--code markup--p-code">SELECT</code> queries into a single result set.</p><p name="0c8f" id="0c8f" class="graf graf--p graf-after--p">In this tutorial, we are going to break down the basics of the <code class="markup--code markup--p-code">SQL UNION</code> operator and discuss where you may want to use this command when you’re working with a database.</p><h3 name="8bae" id="8bae" class="graf graf--h3 graf-after--p">Query Refresher</h3><p name="7177" id="7177" class="graf graf--p graf-after--h3">Programmers use queries to retrieve information from a database. Queries almost always begin with the <code class="markup--code markup--p-code">SQL SELECT</code> statement and are used to retrieve data based on a set of criteria. Queries usually include the <code class="markup--code markup--p-code">FROM</code> operator, which states which table will be queried, among other operators that can filter the resulting data.</p><p name="8619" id="8619" class="graf graf--p graf-after--p">Here is the general syntax for an <code class="markup--code markup--p-code">SQL</code> query:</p><pre name="ec2c" id="ec2c" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">SELECT</strong> column_name <strong class="markup--strong markup--pre-strong">FROM</strong> table_name <strong class="markup--strong markup--pre-strong">WHERE</strong> your_condititions_are_met;</pre><p name="7d68" id="7d68" class="graf graf--p graf-after--pre">Here’s an example of an <code class="markup--code markup--p-code">SQL</code> query that returns a list of all employee names:</p><pre name="961f" id="961f" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">SELECT</strong> name <strong class="markup--strong markup--pre-strong">FROM</strong> employees;</pre><p name="3ba1" id="3ba1" class="graf graf--p graf-after--pre">The output from our query is as follows:</p><p name="1577" id="1577" class="graf graf--p graf-after--p">nameLuke<br>Mike<br>Hannah<br>Geoff<br>Alexis<br>Emma<br>Jonah</p><p name="6270" id="6270" class="graf graf--p graf-after--p">(7 rows)</p><p name="9d24" id="9d24" class="graf graf--p graf-after--p">If you want to retrieve information from multiple columns, you can so do by separating the column names with a comma. If you want to get data from every column, you can use an asterisk (<code class="markup--code markup--p-code">*</code>) instead, which represents every column in a table.</p><p name="239d" id="239d" class="graf graf--p graf-after--p"><a href="https://careerkarma.com/blog/sql-outer-join/" data-href="https://careerkarma.com/blog/sql-outer-join/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><strong class="markup--strong markup--p-strong">» MORE: SQL Outer Join</strong></a></p><h3 name="6680" id="6680" class="graf graf--h3 graf-after--p">SQL Union</h3><p name="73dd" id="73dd" class="graf graf--p graf-after--h3">The <code class="markup--code markup--p-code">SQL UNION</code> operator can be used to combine the results of two or more queries into a single response that results in one table.</p><p name="2be9" id="2be9" class="graf graf--p graf-after--p">In order to use the <code class="markup--code markup--p-code">UNION</code> operator, two conditions must be met. Firstly, the data types of the new columns should be compatible—if a salary is an integer in one table and a float in the other, the union would not work. Secondly, the number and order of the columns must be the same in your queries.</p><p name="5aee" id="5aee" class="graf graf--p graf-after--p">Here’s the syntax for an <code class="markup--code markup--p-code">SQL UNION</code> query:</p><pre name="15ee" id="15ee" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">SELECT</strong> column_name <strong class="markup--strong markup--pre-strong">FROM</strong> table1_name<br><strong class="markup--strong markup--pre-strong">UNION</strong> <strong class="markup--strong markup--pre-strong">SELECT</strong> column_name <strong class="markup--strong markup--pre-strong">FROM</strong> table2_name;</pre><p name="eb3b" id="eb3b" class="graf graf--p graf-after--pre">Let’s use an example to illustrate how the <code class="markup--code markup--p-code">SQL UNION</code> operator works. Let’s say that we are a business that needs to send an announcement to all of our customers. We also want all employees to be sent this announcement so they are aware of what is going on.</p><h3 name="b8f4" id="b8f4" class="graf graf--h3 graf-after--p">SQL Aggregate Functions:</h3><p name="690d" id="690d" class="graf graf--p graf-after--h3">SQL aggregate functions collate information about what is in a database. For instance, you can use SUM to find the total of all the values in a column. Aggregate functions save you time when you need to find out information that involves aggregating records.,</p><p name="f2f4" id="f2f4" class="graf graf--p graf-after--p">Here is a list of the aggregate functions in SQL you can use:</p><ul class="postList"><li name="27b8" id="27b8" class="graf graf--li graf-after--p">COUNT</li><li name="2ac2" id="2ac2" class="graf graf--li graf-after--li">SUM</li><li name="9579" id="9579" class="graf graf--li graf-after--li">AVG</li><li name="e4fa" id="e4fa" class="graf graf--li graf-after--li">MIN</li><li name="ffb1" id="ffb1" class="graf graf--li graf-after--li">MAX</li></ul><p name="6907" id="6907" class="graf graf--p graf-after--li">Let’s walk through each of these individually. We’re going to be referring to a database of employees throughout this tutorial.</p><p name="6fac" id="6fac" class="graf graf--p graf-after--p">Aggregate functions are used at the beginning of the <a href="https://careerkarma.com/blog/sql-select/" data-href="https://careerkarma.com/blog/sql-select/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SQL SELECT statement</a>.</p><p name="7eea" id="7eea" class="graf graf--p graf-after--p">If you query both a column and an aggregate function in the same SELECT statement, you must use an <a href="https://careerkarma.com/blog/sql-group-by/" data-href="https://careerkarma.com/blog/sql-group-by/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SQL GROUP BY clause</a>. This clause tells SQL how to represent the data in your query.</p><h3 name="b2b7" id="b2b7" class="graf graf--h3 graf-after--p">SQL Subquery</h3><p name="e5d1" id="e5d1" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">An SQL subquery is a query inside another query. It is used in the WHERE or HAVING clause of an SQL statement. Subqueries let you specify the results of one query as an argument in another query.</em></p><p name="9012" id="9012" class="graf graf--p graf-after--p">When you’re writing an <em class="markup--em markup--p-em">SQL</em> query, you may want to specify a parameter based on the result of another query. For example, say you have a list of customers. You may want to get a list of customers who have placed orders worth a value over a certain amount. Order and customer information is stored within a different table.</p><p name="7029" id="7029" class="graf graf--p graf-after--p graf--trailing">That’s where the <em class="markup--em markup--p-em">SQL subquery</em> operation comes in. <em class="markup--em markup--p-em">Subqueries</em>, also known as nested queries, are <em class="markup--em markup--p-em">SELECT</em> queries within the <em class="markup--em markup--p-em">WHERE</em> clause of another <em class="markup--em markup--p-em">SQL</em> query. The main <em class="markup--em markup--p-em">SQL</em> query then uses the result of the subquery.</p></div></div></section><section name="1458" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="b3d2" id="b3d2" class="graf graf--figure graf--iframe graf--leading"><script src="https://gist.github.com/bgoonz/d7175b9dd3f7d1c83460f6086216d7dd.js"></script></figure><h3 name="e2e6" id="e2e6" class="graf graf--h3 graf-after--figure">SQL query examples</h3><figure name="14e6" id="14e6" class="graf graf--figure graf--iframe graf-after--h3"><script src="https://gist.github.com/bgoonz/2bbeec3e59f227a5740892f898892ae5.js"></script></figure><p name="0f20" id="0f20" class="graf graf--p graf-after--figure">Now let’s explore some examples of common and useful PostgreSQL queries that can be used in various situations.</p><p name="dacc" id="dacc" class="graf graf--p graf-after--p">From <a href="https://www.postgresql.org/docs/13/app-psql.html" data-href="https://www.postgresql.org/docs/13/app-psql.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">PSQL DOCS:</a></p><h3 name="6fdf" id="6fdf" class="graf graf--h3 graf-after--p">1. CREATE TABLE query in PostgreSQL</h3><h3 name="0c0c" id="0c0c" class="graf graf--h3 graf-after--h3"><a href="https://www.postgresql.org/docs/12/sql-createtable.html" data-href="https://www.postgresql.org/docs/12/sql-createtable.html" class="markup--anchor markup--h3-anchor" rel="noopener" target="_blank">CREATE TABLE</a> is a keyword that will create a new, initially empty table in the database. The table will be owned by the user who has issued this command.</h3><pre name="8a7b" id="8a7b" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> dummy_table(name <strong class="markup--strong markup--pre-strong">varchar</strong>(20),address text,age <strong class="markup--strong markup--pre-strong">int</strong>);<br>      <strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre><h3 name="76b6" id="76b6" class="graf graf--h3 graf-after--pre">2. INSERT query in PostgreSQL</h3><p name="53dd" id="53dd" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-insert.html" data-href="https://www.postgresql.org/docs/12/sql-insert.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">INSERT command</a> is used to insert data into a table:</p><pre name="6cf5" id="6cf5" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;XYZ&#39;,&#39;location-A&#39;,25);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;ABC&#39;,&#39;location-B&#39;,35);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;DEF&#39;,&#39;location-C&#39;,40);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> dummy_table <strong class="markup--strong markup--pre-strong">values</strong>(&#39;PQR&#39;,&#39;location-D&#39;,54);<br>        <strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre><h3 name="ff19" id="ff19" class="graf graf--h3 graf-after--pre">3. SELECT query without WHERE condition in PostgreSQL</h3><p name="d1cf" id="d1cf" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-select.html" data-href="https://www.postgresql.org/docs/12/sql-select.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SELECT command</a> (when used without the optional WHERE condition) is used to fetch all data from a database table:</p><pre name="36e0" id="36e0" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br>        name |  address   | age <br>        <em class="markup--em markup--pre-em">---------+--------------+ -----</em><br>        XYZ   | location-A |  25<br>        ABC   | location-B |  35<br>        DEF   | location-C |  40<br>        PQR   | location-D |  54<br>        (4 rows)</code></pre><h3 name="a773" id="a773" class="graf graf--h3 graf-after--pre">4. UPDATE query in PostgreSQL</h3><p name="52fb" id="52fb" class="graf graf--p graf-after--h3"><a href="https://www.postgresql.org/docs/12/sql-update.html" data-href="https://www.postgresql.org/docs/12/sql-update.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">UPDATE</a> is used to make updates to the data or row(s) of a database table. In the example below we use UPDATE to change the age of a person whose name is ‘PQR’:</p><pre name="cce1" id="cce1" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=50 <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;PQR&#39;;<br>        <strong class="markup--strong markup--pre-strong">UPDATE</strong> 1<br>        postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br>        name |  address   | age <br>        <em class="markup--em markup--pre-em">--------+--------------+-------</em><br>        XYZ  | location-A |  25<br>        ABC  | location-B |  35<br>        DEF  | location-C |  40<br>        PQR  | location-D |  50<br>        (4 rows)</code></pre><p name="7ae7" id="7ae7" class="graf graf--p graf-after--pre">Next, we’ll use the UPDATE command to change the name and age of a person whose address is ‘location-D’:</p><pre name="d0fe" id="d0fe" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> name=&#39;GHI&#39;,age=54 <strong class="markup--strong markup--pre-strong">where</strong> address=&#39;location-D&#39;;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> GHI  | location-D |  54<br>(4 rows)<br><br>postgres=#</code></pre><p name="c074" id="c074" class="graf graf--p graf-after--pre">If we want to modify all the values in the address and age columns in dummy_table, then we do not need to use the WHERE clause. The UPDATE query would look like this:</p><pre name="1ac7" id="1ac7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=54,address=&#39;location-X&#39;;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 4<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table ;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+--------</em><br> XYZ  | location-X |  54<br> ABC  | location-X |  54<br> DEF  | location-X |  54<br> GHI  | location-X |  54<br>(4 rows)<br><br>postgres=#</code></pre><p name="a8dd" id="a8dd" class="graf graf--p graf-after--pre">A RETURNING clause returns the updated rows. This is optional in UPDATE:</p><pre name="c357" id="c357" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">update</strong> dummy_table <strong class="markup--strong markup--pre-strong">set</strong> age=30 <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;XYZ&#39; returning age <strong class="markup--strong markup--pre-strong">as</strong> age_no;<br> age_no <br><em class="markup--em markup--pre-em">---------</em><br>      30<br>(1 row)<br><br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 1</code></pre><p name="0d3a" id="0d3a" class="graf graf--p graf-after--pre">It is always recommended to perform such operations under transaction blocks (i.e., BEGIN...COMMIT/ROLLBACK;), so we have the option to roll back the operation.</p><h3 name="3dd8" id="3dd8" class="graf graf--h3 graf-after--p">5. DELETE query in PostgreSQL</h3><p name="aba5" id="aba5" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-delete.html" data-href="https://www.postgresql.org/docs/12/sql-delete.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">DELETE command</a> is used to delete row(s). It can be used with or without the optional WHERE condition, but take note: if the WHERE condition is missing, the command will delete all rows, leaving you with an empty table.</p><p name="eaf8" id="eaf8" class="graf graf--p graf-after--p">In this example, we are deleting one row whose age column has the value 65:</p><pre name="cf60" id="cf60" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">delete</strong> <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=65;<br><strong class="markup--strong markup--pre-strong">DELETE</strong> 1<br>postgres=#</code></pre><h3 name="4851" id="4851" class="graf graf--h3 graf-after--pre">6. Comparison Operators in PostgreSQL queries</h3><p name="78f6" id="78f6" class="graf graf--p graf-after--h3">In PostgreSQL, with the help of <a href="https://www.postgresql.org/docs/12/functions-comparison.html" data-href="https://www.postgresql.org/docs/12/functions-comparison.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">comparison operators</a> we can find results where the value in a column is not equal to the specified condition or value.</p><h3 name="128a" id="128a" class="graf graf--h3 graf-after--p">Less than or equal to query:</h3><pre name="c397" id="c397" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age &lt;=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> PQR  | location-D |  50<br>(4 rows)</code></pre><h3 name="91c5" id="91c5" class="graf graf--h3 graf-after--pre">Greater than or equal to query:</h3><pre name="721a" id="721a" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age&gt;=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre><h3 name="56ba" id="56ba" class="graf graf--h3 graf-after--pre">Not equal to query:</h3><pre name="0ae7" id="0ae7" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age&lt;&gt;50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br>(3 rows)</code></pre><h3 name="19b2" id="19b2" class="graf graf--h3 graf-after--pre">Equal to query:</h3><pre name="81bf" id="81bf" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=50;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre><h3 name="d0d7" id="d0d7" class="graf graf--h3 graf-after--pre">7. SELECT DISTINCT query in PostgreSQL</h3><p name="6210" id="6210" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-select.html#SQL-DISTINCT" data-href="https://www.postgresql.org/docs/12/sql-select.html#SQL-DISTINCT" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SELECT DISTINCT</a> statement is used to return only distinct values from the table. It removes any duplicate values.</p><h3 name="9c75" id="9c75" class="graf graf--h3 graf-after--p">SELECT query without DISTINCT clause</h3><pre name="1573" id="1573" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>   1<br>   1<br>   2<br>   2<br>   3<br>(5 rows)</code></pre><h3 name="a026" id="a026" class="graf graf--h3 graf-after--pre">SELECT query with DISTINCT clause</h3><pre name="ac0e" id="ac0e" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">distinct</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>   1<br>   2<br>   3<br>(3 rows)</code></pre><h3 name="d198" id="d198" class="graf graf--h3 graf-after--pre">8. TRUNCATE query in PostgreSQL</h3><p name="d804" id="d804" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-truncate.html" data-href="https://www.postgresql.org/docs/12/sql-truncate.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">TRUNCATE command</a> is used to empty a table:</p><pre name="6dff" id="6dff" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">truncate</strong> <strong class="markup--strong markup--pre-strong">table</strong> dummy_table;<br><strong class="markup--strong markup--pre-strong">TRUNCATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre><h3 name="6300" id="6300" class="graf graf--h3 graf-after--pre">9. DROP TABLE query in PostgreSQL</h3><p name="f379" id="f379" class="graf graf--p graf-after--h3">This <a href="https://www.postgresql.org/docs/12/sql-droptable.html" data-href="https://www.postgresql.org/docs/12/sql-droptable.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">DROP TABLE command</a> is used to drop a table from the database:</p><pre name="49dc" id="49dc" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">drop</strong> <strong class="markup--strong markup--pre-strong">table</strong> <strong class="markup--strong markup--pre-strong">if</strong> <strong class="markup--strong markup--pre-strong">exists</strong> dummy;<br>NOTICE:  table &quot;dummy&quot; does not exist, skipping<br><strong class="markup--strong markup--pre-strong">DROP</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong></code></pre><p name="ba42" id="ba42" class="graf graf--p graf-after--pre">This command has removed the full table, including any associated data, indexes, rules, triggers, and constraints for that table.</p><h3 name="57d0" id="57d0" class="graf graf--h3 graf-after--p">10. CREATE VIEW query in PostgreSQL</h3><p name="f8be" id="f8be" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-createview.html" data-href="https://www.postgresql.org/docs/12/sql-createview.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CREATE VIEW</a> command is used to generate views. Views are pseudo-tables, which are used to present a full table, subset, or select columns from the underlying table:</p><pre name="adbd" id="adbd" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> <strong class="markup--strong markup--pre-strong">view</strong> vi <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">VIEW</strong></code></pre><h3 name="20f7" id="20f7" class="graf graf--h3 graf-after--pre">11. Create a table in Postgresql using the SELECT statement</h3><p name="d3da" id="d3da" class="graf graf--p graf-after--h3">Using the syntax in the example below, we can create a table using a SELECT statement:</p><pre name="54d6" id="54d6" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> &#39;My name  is X&#39; <strong class="markup--strong markup--pre-strong">as</strong> col1 , 10 <strong class="markup--strong markup--pre-strong">as</strong> col2, &#39;Address is -XYZ location&#39; <strong class="markup--strong markup--pre-strong">as</strong> col3  <strong class="markup--strong markup--pre-strong">into</strong> new_table;<br><strong class="markup--strong markup--pre-strong">SELECT</strong> 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> new_table ;<br>     col1      | col2 |           col3           <br><em class="markup--em markup--pre-em">---------------+------+--------------------------</em><br> My name  is X |   10 | Address is -XYZ location<br>(1 row)</code></pre><h3 name="a11b" id="a11b" class="graf graf--h3 graf-after--pre">12. Query timeout in PostgreSQL</h3><p name="a90a" id="a90a" class="graf graf--p graf-after--h3">We can command a query to timeout after a certain period with the help of <a href="https://www.enterprisedb.com/postgres-tutorials/how-tune-postgresql-guc-parameters" data-href="https://www.enterprisedb.com/postgres-tutorials/how-tune-postgresql-guc-parameters" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">GUC parameters</a> (short for grand unified configuration) like statement_timeout, which aborts any statement that takes more than the specified number of milliseconds:</p><pre name="677c" id="677c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">set</strong> statement_timeout=10;<br><strong class="markup--strong markup--pre-strong">SET</strong><br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> pg_sleep(20);<br>ERROR:  canceling statement due to statement timeout</code></pre><h3 name="773b" id="773b" class="graf graf--h3 graf-after--pre">13. Using CREATE SEQUENCE with the INSERT query in PostgreSQL</h3><p name="b662" id="b662" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/sql-createsequence.html" data-href="https://www.postgresql.org/docs/12/sql-createsequence.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CREATE SEQUENCE</a> command is a sequential number generator. Once the sequence is created, we can use the sequence’s nextval and currval functions to insert values into a table:</p><pre name="648d" id="648d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> sequence seq;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> SEQUENCE<br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> tab(n <strong class="markup--strong markup--pre-strong">int</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (nextval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (currval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> tab <strong class="markup--strong markup--pre-strong">values</strong> (nextval(&#39;seq&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> tab;<br> n <br><em class="markup--em markup--pre-em">---</em><br> 1<br> 1<br> 2<br>(3 rows)</code></pre><h3 name="5a1b" id="5a1b" class="graf graf--h3 graf-after--pre">14. Importing BLOB data types into PostgreSQL</h3><p name="a8f5" id="a8f5" class="graf graf--p graf-after--h3">PostgreSQL doesn’t directly support BLOBs (binary large objects), but we can work with them using the following methods:</p><p name="758d" id="758d" class="graf graf--p graf-after--p">Let&#39;s assume you have an image (in png format) downloaded in the /home/edb/ folder:</p><pre name="716b" id="716b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[edb@localhost]$ ls /home/edb/mypic.png <br>/home/edb/mypic.png</code></pre><p name="60cb" id="60cb" class="graf graf--p graf-after--pre">We want to store this image in the PostgreSQL database.</p><p name="005a" id="005a" class="graf graf--p graf-after--p">Go to the bin folder of your PostgreSQL installation and connect to the psql terminal:</p><pre name="34fa" id="34fa" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">Create</strong> <strong class="markup--strong markup--pre-strong">table</strong> testing(n <strong class="markup--strong markup--pre-strong">int</strong>,n1 oid);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testing <strong class="markup--strong markup--pre-strong">values</strong> (1,lo_import(&#39;/home/edb/mypic.png&#39;));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre><p name="ad49" id="ad49" class="graf graf--p graf-after--pre">The lo_import() function loads the named file into pg_largeobject and returns an OID (object identifier) value that will refer to the large object. Selecting the testing table will show just the OID and not the bits that have made up this photo.</p><h3 name="6a49" id="6a49" class="graf graf--h3 graf-after--p">15. ILIKE query in PostgreSQL</h3><p name="db47" id="db47" class="graf graf--p graf-after--h3">The ILIKE operator is a <a href="https://www.postgresql.org/docs/12/functions-matching.html" data-href="https://www.postgresql.org/docs/12/functions-matching.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">matching function</a> similar to the LIKE operator, but with the advantage that it matches valus case-insensitively.</p><pre name="b0aa" id="b0aa" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> ted;<br>  n  <br><em class="markup--em markup--pre-em">-----</em><br> TAR<br> TaR<br> Tar<br> tar<br>(4 rows)</code></pre><h3 name="afc4" id="afc4" class="graf graf--h3 graf-after--pre">Using ILIKE in a WHERE condition</h3><pre name="2453" id="2453" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> ted <strong class="markup--strong markup--pre-strong">where</strong> n <strong class="markup--strong markup--pre-strong">ilike</strong> &#39;TAR%&#39;;<br>  n  <br><em class="markup--em markup--pre-em">-----</em><br> TAR<br> TaR<br> Tar<br> tar<br>(4 rows)</code></pre><h3 name="5d1e" id="5d1e" class="graf graf--h3 graf-after--pre">16. Hierarchical queries in PostgreSQL</h3><p name="1786" id="1786" class="graf graf--p graf-after--h3"><a href="https://www.enterprisedb.com/postgres-tutorials/how-run-hierarchical-queries-oracle-and-postgresql" data-href="https://www.enterprisedb.com/postgres-tutorials/how-run-hierarchical-queries-oracle-and-postgresql" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Hierarchical queries</a> are ones where the results have a structured or parent-child relationship and are displayed in a tree structure. To see how hierarchical queries work, create a dummy table:</p><pre name="cc2f" id="cc2f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> test_table(  <br>  emp_no                <strong class="markup--strong markup--pre-strong">int</strong>,  <br>  ename                 <strong class="markup--strong markup--pre-strong">char</strong>(5),  <br>  job                       <strong class="markup--strong markup--pre-strong">char</strong>(9),  <br>  manager_no        <strong class="markup--strong markup--pre-strong">int</strong><br>);</code></pre><p name="2139" id="2139" class="graf graf--p graf-after--pre">Insert data into ‘test_table’:</p><pre name="998e" id="998e" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(10,&#39;A1&#39;,&#39;CEO&#39;,<strong class="markup--strong markup--pre-strong">null</strong>);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(11, &#39;B1&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(12, &#39;B2&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(13, &#39;B3&#39;, &#39;VP&#39;, 10);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(14, &#39;C1&#39;, &#39;DIRECTOR&#39;, 13);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(15, ‘C2’, ‘DIRECTOR’, 13);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(16, &#39;D1&#39;, &#39;MANAGER&#39;, 15);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(17 ,&#39;E1&#39;, &#39;ENGINEER&#39;, 11);<br><strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> test_table <strong class="markup--strong markup--pre-strong">values</strong>(18, &#39;E2&#39;, &#39;ENGINEER&#39;, 11);</code></pre><p name="1ec9" id="1ec9" class="graf graf--p graf-after--pre">We can perform hierarchical queries on this table using the methods below.</p><h3 name="bc21" id="bc21" class="graf graf--h3 graf-after--p">17. Length function in PostgreSQL</h3><p name="d8fa" id="d8fa" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/9.1/functions-string.html" data-href="https://www.postgresql.org/docs/9.1/functions-string.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">length function</a> returns the number of characters or number of bytes in a specified string variable.</p><h3 name="7578" id="7578" class="graf graf--h3 graf-after--p">Basic SELECT query</h3><pre name="9500" id="9500" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> name,age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name | age <br><em class="markup--em markup--pre-em">------+-----</em><br> XYZ  |  25<br> ABC  |  35<br> DEF  |  40<br> PQR  |  54<br> PQR  |    <br>(5 rows)</code></pre><h3 name="1ab9" id="1ab9" class="graf graf--h3 graf-after--pre">Query with length function for column name and age</h3><pre name="d73e" id="d73e" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> length(name),length(age) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> length | length <br><em class="markup--em markup--pre-em">--------+--------</em><br>      3 |      2<br>      3 |      2<br>      3 |      2<br>      3 |      2<br>      3 |       <br>(5 rows)</code></pre><h3 name="fb16" id="fb16" class="graf graf--h3 graf-after--pre">18. When a query has no destination for result data in PostgreSQL</h3><p name="2378" id="2378" class="graf graf--p graf-after--h3">Say that while selecting a given function, we receive the error message below:</p><pre name="c893" id="c893" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgresql=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> now();<br>return 1;<br> <strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br>ERROR:  query has no destination for result data<br>HINT:  If you want to discard the results of a <strong class="markup--strong markup--pre-strong">SELECT</strong>, use PERFORM instead.</code></pre><p name="791b" id="791b" class="graf graf--p graf-after--pre">To avoid such errors, we can either use PERFORM or declare a variable and use it in a <a href="https://www.postgresql.org/docs/9.1/sql-selectinto.html" data-href="https://www.postgresql.org/docs/9.1/sql-selectinto.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">SELECT INTO</a> statement:</p><h3 name="4e89" id="4e89" class="graf graf--h3 graf-after--p">Using PERFORM</h3><pre name="e1f0" id="e1f0" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">begin</strong> <br>perform<br>now(); <br> return 1; <br> <strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br> f <br><em class="markup--em markup--pre-em">---</em><br> 1<br>(1 row)</code></pre><h3 name="da73" id="da73" class="graf graf--h3 graf-after--pre">Declaring a variable and using it in a SELECT INTO statement</h3><pre name="dd15" id="dd15" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">or</strong> <strong class="markup--strong markup--pre-strong">replace</strong> function f(n <strong class="markup--strong markup--pre-strong">int</strong>) <br>returns <strong class="markup--strong markup--pre-strong">int</strong> <br><strong class="markup--strong markup--pre-strong">as</strong> <br>$$ <br><strong class="markup--strong markup--pre-strong">declare</strong> <br>a <strong class="markup--strong markup--pre-strong">date</strong>;<br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> now() <strong class="markup--strong markup--pre-strong">into</strong> a;<br>raise notice ‘%s’,a; <br>return 1; <br><strong class="markup--strong markup--pre-strong">end</strong>; <br>$$ language &#39;plpgsql&#39;;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION<br> <br> <br>postgresql=# <strong class="markup--strong markup--pre-strong">select</strong> f(9);<br>          NOTICE: 24-SEP-20 13:15:46.23388s<br>             f<br>            <em class="markup--em markup--pre-em">---</em><br>            1<br>        (1 row)</code></pre><h3 name="8007" id="8007" class="graf graf--h3 graf-after--pre">19. Exporting query result to a text file in PostgreSQL</h3><p name="4e04" id="4e04" class="graf graf--p graf-after--h3">With the help of the <a href="https://www.postgresql.org/docs/12/sql-copy.html" data-href="https://www.postgresql.org/docs/12/sql-copy.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">COPY command</a>, we can export data from a table to an outside text file as well as import data from a text file into a table.</p><h3 name="d728" id="d728" class="graf graf--h3 graf-after--p">Exporting data from a table to a text file</h3><pre name="c3a8" id="c3a8" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em">#  copy dummy_table to &#39;/tmp/abc.txt&#39;;</em><br>COPY 5<br>  <br>postgres=<em class="markup--em markup--pre-em"># \! cat /tmp/abc.txt</em><br>XYZ	location-A	25<br>ABC	location-B	35<br>DEF	location-C	40<br>PQR	location-D	50<br>CXC	1	50</code></pre><h3 name="39d3" id="39d3" class="graf graf--h3 graf-after--pre">Importing data from a text file into a table</h3><pre name="b375" id="b375" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># copy dummy_table from &#39;/tmp/abc.txt&#39;;</em><br>COPY 5</code></pre><ul class="postList"><li name="8e52" id="8e52" class="graf graf--li graf-after--pre">With the help of common table expressions (CTE):</li></ul><pre name="1154" id="1154" class="graf graf--pre graf-after--li">postgres=#WITH RECURSIVE cte AS (                                                                                                                                                          SELECT emp_no, ename, manager_no, 1 AS level                                                                                                                                             FROM   test_table                                                                                                                                                                      where manager_no is null                                                                                                                                                            UNION  ALL                                                                                                                                                                               SELECT e.emp_no, e.ename, e.manager_no, c.level + 1                                                                                                                                      FROM   cte c                                                                                                                                                                             JOIN   test_table e ON e.manager_no = c.emp_no                                                                                  )                                                                                                                                                                                     SELECT *                                                                                                                                                                                 FROM   cte;  emp_no | ename | manager_no | level  -----------+----------+------------------+-------      10    | A1        |                        |     1      11    | B1        |          10          |     2      12    | B2        |          10          |     2      13    | B3        |          10          |     2      14    | C1        |         13           |     3      17    | E1        |          11          |      3      18    | E2        |          11           |     3      15    | C2        |          13           |     3      16    | D1        |          15           |     4 (9 rows)  postgres=#</pre><ul class="postList"><li name="b6ad" id="b6ad" class="graf graf--li graf-after--pre">Using the tablefunc extension:</li></ul><ol class="postList"><li name="c6e2" id="c6e2" class="graf graf--li graf-after--li">The <a href="https://www.postgresql.org/docs/8.3/tablefunc.html" data-href="https://www.postgresql.org/docs/8.3/tablefunc.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">tablefunc extension</a> is a contrib module that resides in the contrib/ folder in PostgreSQL sources.</li><li name="2847" id="2847" class="graf graf--li graf-after--li">First, create the tablefunc extension:</li></ol><ul class="postList"><li name="3505" id="3505" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--li-strong">CREATE</strong> EXTENSION tablefunc; <strong class="markup--strong markup--li-strong">CREATE</strong> EXTENSION postgres=#</code></li></ul><ol class="postList"><li name="b334" id="b334" class="graf graf--li graf-after--li">Then, use tablefunc’s connectby function to display results hierarchically:</li></ol><pre name="e7f5" id="e7f5" class="graf graf--pre graf-after--li">postgres=# SELECT * FROM connectby(&#39;dummy_table&#39;, &#39;emp_no&#39;, &#39;manager_no&#39;, &#39;10&#39;, 0, &#39;-&gt;&#39;) AS t(emp_no int, manager_no int, level int, ord text) order by emp_no;   emp_no | manager_no | level |      ord         --------+------------+-------+----------------       10 |                       |      0        | 10       11 |              10     |      1        | 10-&gt;11       12 |              10     |      1        | 10-&gt;12       13 |              10     |      1        | 10-&gt;13       14 |              13     |      2        | 10-&gt;13-&gt;14       15 |              13     |      2        | 10-&gt;13-&gt;15       16 |              15     |      3        | 10-&gt;13-&gt;15-&gt;16       17 |              11     |      2        | 10-&gt;11-&gt;17       18 |              11     |      2        | 10-&gt;11-&gt;18  (9 rows)   postgres=#</pre><h3 name="10ac" id="10ac" class="graf graf--h3 graf-after--pre">20. Listing databases query in PostgreSQL</h3><p name="f67d" id="f67d" class="graf graf--p graf-after--h3">The following query can be used to show all the databases created:</p><pre name="8635" id="8635" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> oid,datname <strong class="markup--strong markup--pre-strong">from</strong> pg_database;<br>  oid     |  datname  <br><em class="markup--em markup--pre-em">-----------+-----------</em><br> 13743 | postgres<br>     1     | template1<br> 13742 | template0<br>(3 rows)</code></pre><p name="332e" id="332e" class="graf graf--p graf-after--pre">We can also list out all the database names using the \l command at the psql prompt.</p><h3 name="0e83" id="0e83" class="graf graf--h3 graf-after--p">21. Checking query execution time in PostgreSQL</h3><p name="0e1a" id="0e1a" class="graf graf--p graf-after--h3">We can check the time needed for a query to execute by enabling \timing at the psql prompt:</p><pre name="90ec" id="90ec" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># \timing</em><br>Timing <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">on</strong>.</code></pre><p name="9114" id="9114" class="graf graf--p graf-after--pre">The SELECT query will now show the execution time:</p><pre name="1867" id="1867" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+--------</em><br> XYZ  | location-A | 25<br> ABC  | location-B | 35<br> DEF  | location-C | 40<br> PQR  | location-D | 50<br> CXC  | 1               | 50<br>(5 rows)<br> <br>Time: 0.440 ms<br>postgres=#</code></pre><h3 name="92da" id="92da" class="graf graf--h3 graf-after--pre">22. Dynamic SQL query in PostgreSQL</h3><p name="d00d" id="d00d" class="graf graf--p graf-after--h3"><a href="https://www.postgresql.org/docs/9.1/ecpg-dynamic.html" data-href="https://www.postgresql.org/docs/9.1/ecpg-dynamic.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Dynamic SQL</a> is used to reduce repetitive tasks when it comes to querying.<br>Dynamic SQL queries are not cached in memory.</p><pre name="b850" id="b850" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># do</em><br>postgres-<em class="markup--em markup--pre-em"># $$</em><br>postgres$# <strong class="markup--strong markup--pre-strong">begin</strong><br>postgres$# execute &#39;select * from dummy_table&#39;;<br>postgres$# <strong class="markup--strong markup--pre-strong">end</strong>;<br>postgres$# $$;<br>DO</code></pre><h3 name="48cc" id="48cc" class="graf graf--h3 graf-after--pre">23. COUNT query in PostgreSQL</h3><p name="8e13" id="8e13" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/8.2/functions-aggregate.html" data-href="https://www.postgresql.org/docs/8.2/functions-aggregate.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">COUNT query</a> returns the number of rows in a table. If we use (*) this will include null values; otherwise null values will be excluded.</p><pre name="18d3" id="18d3" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">count</strong>(*) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> count <br><em class="markup--em markup--pre-em">-------</em><br>     5<br>(1 row)<br> <br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">count</strong>(<strong class="markup--strong markup--pre-strong">avg</strong>) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> count <br><em class="markup--em markup--pre-em">-------</em><br>     4<br>(1 row)</code></pre><h3 name="7e54" id="7e54" class="graf graf--h3 graf-after--pre">24. LIMIT and OFFSET query in PostgreSQL</h3><p name="e575" id="e575" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/queries-limit.html" data-href="https://www.postgresql.org/docs/12/queries-limit.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LIMIT clause</a> is used to limit the data amount returned by the SELECT statement. The query below will display only 1 row:</p><pre name="febd" id="febd" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  limit 1;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br>(1 row)</code></pre><p name="0c98" id="0c98" class="graf graf--p graf-after--pre"><a href="https://www.postgresql.org/docs/12/queries-limit.html" data-href="https://www.postgresql.org/docs/12/queries-limit.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">OFFSET</a> is used when we want to skip a particular number of rows:</p><pre name="8637" id="8637" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  offset 4;<br> name | address | age <br><em class="markup--em markup--pre-em">------+---------+-----</em><br> cxc  | 1       |  50<br>(1 row)</code></pre><h3 name="1b8b" id="1b8b" class="graf graf--h3 graf-after--pre">25. IF … ELSE expression in PostgreSQL</h3><p name="9e72" id="9e72" class="graf graf--p graf-after--h3">We can use <a href="https://www.postgresql.org/docs/9.1/plpgsql-control-structures.html" data-href="https://www.postgresql.org/docs/9.1/plpgsql-control-structures.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">conditional statements</a> like IF ... ELSE in an anonymous block. The example below checks if the values of variables abc and xyz are matching and prints the result— i.e., 150:</p><pre name="2330" id="2330" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">Do</strong> <br>             $$<br>             <strong class="markup--strong markup--pre-strong">Declare</strong><br>              abc <strong class="markup--strong markup--pre-strong">int</strong>;<br>              xyz int;<br>              <strong class="markup--strong markup--pre-strong">begin</strong><br>              abc:=100;<br>              xyz:=abc;<br>              if abc=xyz then <br>               xyz=150;  <br>              raise notice &#39;%&#39;,xyz;<br>             else<br>             <strong class="markup--strong markup--pre-strong">end</strong> <strong class="markup--strong markup--pre-strong">if</strong>;               <br>             <strong class="markup--strong markup--pre-strong">end</strong>;<br>               $$<br>;<br>NOTICE:  150<br><strong class="markup--strong markup--pre-strong">DO</strong></code></pre><h3 name="ba88" id="ba88" class="graf graf--h3 graf-after--pre">26. UPDATE with JOIN query in PostgreSQL</h3><p name="c981" id="c981" class="graf graf--p graf-after--h3">We can use UPDATE with a JOIN and WHERE clause when we want to update the values from one table (table X) based on values from another table (table Y):</p><pre name="6dde" id="6dde" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> X(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 <strong class="markup--strong markup--pre-strong">char</strong>(10));<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;abc&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;xyz&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> X <strong class="markup--strong markup--pre-strong">values</strong> (3,&#39;pqr&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> Y(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 <strong class="markup--strong markup--pre-strong">char</strong>(10));<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> Y <strong class="markup--strong markup--pre-strong">values</strong> (5,&#39;axyz&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br>postgres=# <strong class="markup--strong markup--pre-strong">update</strong> Y <strong class="markup--strong markup--pre-strong">set</strong> n1=X.n1 <strong class="markup--strong markup--pre-strong">from</strong> X  <strong class="markup--strong markup--pre-strong">where</strong> X.n=Y.n;<br><strong class="markup--strong markup--pre-strong">UPDATE</strong> 2<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> Y;<br> n |     n1     <br><em class="markup--em markup--pre-em">---+------------</em><br> 5 | axyz      <br> 1 | abc       <br> 2 | xyz       <br>(3 rows)<br><br>postgres=#</code></pre><h3 name="d75b" id="d75b" class="graf graf--h3 graf-after--pre">27. INNER JOIN query in PostgreSQL</h3><p name="d2ca" id="d2ca" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/current/tutorial-join.html" data-href="https://www.postgresql.org/docs/current/tutorial-join.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">INNER JOIN</a> command will find rows from two (or more) tables where the specified columns data in the tables match:</p><pre name="b1f7" id="b1f7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> *  <strong class="markup--strong markup--pre-strong">from</strong> x <strong class="markup--strong markup--pre-strong">inner</strong> <strong class="markup--strong markup--pre-strong">join</strong>  y <strong class="markup--strong markup--pre-strong">on</strong>  x.n1 = y.n1;<br> n |     n1     | n |     n1     <br><em class="markup--em markup--pre-em">---+------------+---+------------</em><br> 1 | abc        | 1 | abc       <br> 2 | xyz        | 2 | xyz       <br>(2 rows)<br><br>postgres=#</code></pre><h3 name="41f2" id="41f2" class="graf graf--h3 graf-after--pre">28. CASE expression in PostgreSQL</h3><p name="2698" id="2698" class="graf graf--p graf-after--h3">The <a href="https://www.postgresql.org/docs/12/functions-conditional.html" data-href="https://www.postgresql.org/docs/12/functions-conditional.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">CASE expression</a> is a generic conditional expression, similar to the IF … ELSE statement.</p><pre name="2c5c" id="2c5c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">SELECT</strong> age,<br>       <strong class="markup--strong markup--pre-strong">CASE</strong> age <strong class="markup--strong markup--pre-strong">WHEN</strong> 25 <strong class="markup--strong markup--pre-strong">THEN</strong> &#39;one&#39;<br>              <strong class="markup--strong markup--pre-strong">WHEN</strong> 50 <strong class="markup--strong markup--pre-strong">THEN</strong> &#39;two&#39;<br>              <strong class="markup--strong markup--pre-strong">ELSE</strong> &#39;other&#39;<br>       <strong class="markup--strong markup--pre-strong">END</strong><br>    <strong class="markup--strong markup--pre-strong">FROM</strong>  dummy_table;<br> age | case  <br><em class="markup--em markup--pre-em">-----+-------</em><br>  25 | one<br>  35 | other<br>  40 | other<br>  50 | two<br>  50 | two<br>(5 rows)</code></pre><h3 name="70c1" id="70c1" class="graf graf--h3 graf-after--pre">29. PostgreSQL recursive query</h3><p name="d300" id="d300" class="graf graf--p graf-after--h3">Recursive queries are used to deal with hierarchical queries or tree-structured data. The structure of a WITH RECURSIVE query is always: a) Non-recursive term<br> b) UNION (or UNION ALL), then a recursive term</p><p name="a81d" id="a81d" class="graf graf--p graf-after--p">where the recursive term includes a reference to the query&#39;s output.</p><pre name="c651" id="c651" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> emp_test (<br>  id <strong class="markup--strong markup--pre-strong">int</strong>,<br>  ename <strong class="markup--strong markup--pre-strong">varchar</strong>(255),<br>  emanager <strong class="markup--strong markup--pre-strong">int</strong><br>);<br><br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (1, &#39;abc&#39;, <strong class="markup--strong markup--pre-strong">null</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (2, &#39;xyz&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (3, &#39;def&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (4, &#39;cde&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (5, &#39;qrs&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (9, &#39;iop&#39;, 3);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> emp_test <strong class="markup--strong markup--pre-strong">VALUES</strong> (10, &#39;klm&#39;, 4);</code></pre><p name="6dad" id="6dad" class="graf graf--p graf-after--pre">The recursive query below will give all the reports in a certain order:</p><pre name="da1b" id="da1b" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=#WITH RECURSIVE emp_testnew  AS (<br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> id, ename, emanager<br>  <strong class="markup--strong markup--pre-strong">FROM</strong> emp_test<br>  <strong class="markup--strong markup--pre-strong">WHERE</strong> id = 2<br>  <strong class="markup--strong markup--pre-strong">UNION</strong> <strong class="markup--strong markup--pre-strong">ALL</strong><br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> e.id, e.ename, e.emanager<br>  <strong class="markup--strong markup--pre-strong">FROM</strong> emp_test e<br>  <strong class="markup--strong markup--pre-strong">INNER</strong> <strong class="markup--strong markup--pre-strong">JOIN</strong> emp_testnew e1 <strong class="markup--strong markup--pre-strong">ON</strong> e1.id = e.emanager<br>)<br><strong class="markup--strong markup--pre-strong">SELECT</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> emp_testnew;<br><br> id | ename | emanager <br><em class="markup--em markup--pre-em">----+-------+----------</em><br>  2 | xyz   |        1<br>  3 | def   |        2<br>  5 | qrs   |        2<br>  9 | iop   |        3<br>(4 rows)<br><br>postgres=#</code></pre><h3 name="7ab4" id="7ab4" class="graf graf--h3 graf-after--pre">30. PostgreSQL log queries</h3><p name="43dd" id="43dd" class="graf graf--p graf-after--h3">Using the <a href="https://www.postgresql.org/docs/12/pgstatstatements.html" data-href="https://www.postgresql.org/docs/12/pgstatstatements.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">pg_stat_statements module</a>, we can track execution statistics for all SQL statements. To do this, we need to create an extension and add in shared_preload_libraries inside the postgresql.conf file:</p><pre name="d134" id="d134" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> extension pg_stat_statements;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> EXTENSION<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">show</strong> shared_preload_libraries ;<br>                           shared_preload_libraries                           <br><em class="markup--em markup--pre-em">-------------------------------------------------</em><br> $libdir/pg_stat_statements<br>(1 row)<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> query <strong class="markup--strong markup--pre-strong">from</strong> pg_stat_statements <strong class="markup--strong markup--pre-strong">where</strong> query <strong class="markup--strong markup--pre-strong">like</strong> &#39;create table%&#39;;<br>-[ RECORD 1 ]<em class="markup--em markup--pre-em">-------------------</em><br>query | <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> test(n <strong class="markup--strong markup--pre-strong">int</strong>)</code></pre><p name="f4a3" id="f4a3" class="graf graf--p graf-after--pre">We can also configure PostgreSQL to generate log output by enabling these parameters in the postgresql.conf file:</p><pre name="2856" id="2856" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">logging_collector = on<br>log_directory = &#39;log&#39;<br>log_filename = ‘postgresql-%Y-%m-%d_%H%M%S.<strong class="markup--strong markup--pre-strong">log</strong>&#39;<br>log_destination = ‘stderr’<br>Log file will be created under the pg_log directory which resides under the data folder. <br><br>[centos@tushar-ldap-docker bin]$ ls  data/log<br>postgresql-2020-09-17_150932.log  postgresql-2020-09-19_000000.log  <br>[centos@tushar-ldap-docker bin]$</code></pre><p name="d999" id="d999" class="graf graf--p graf-after--pre">Queries will be recorded in these files.</p><h3 name="d8b8" id="d8b8" class="graf graf--h3 graf-after--p">31. Using a variable in a PostgreSQL query</h3><p name="17a1" id="17a1" class="graf graf--p graf-after--h3">We can declare a variable in PostgreSQL at the psql prompt:</p><pre name="2cc7" id="2cc7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<em class="markup--em markup--pre-em"># \set cond 50</em></code></pre><h3 name="7ac8" id="7ac8" class="graf graf--h3 graf-after--pre">Using a variable in a WHERE condition</h3><pre name="7f28" id="7f28" class="graf graf--pre graf-after--h3"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=:cond;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> PQR  | location-D |  50<br>(1 row)</code></pre><p name="88a1" id="88a1" class="graf graf--p graf-after--pre">OR</p><pre name="bddb" id="bddb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# \<strong class="markup--strong markup--pre-strong">set</strong> cond 50<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> :cond+100 ;<br> ?column? <br><em class="markup--em markup--pre-em">----------</em><br>      150<br>(1 row)</code></pre><h3 name="8142" id="8142" class="graf graf--h3 graf-after--pre">32. Date query in PostgreSQL</h3><p name="ebd8" id="ebd8" class="graf graf--p graf-after--h3">PostgreSQL offers <a href="https://www.postgresql.org/docs/12/functions-datetime.html" data-href="https://www.postgresql.org/docs/12/functions-datetime.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">functions for date and time</a> that can be used in queries.</p><pre name="47ad" id="47ad" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> now();<br>               now                <br><em class="markup--em markup--pre-em">----------------------------------</em><br> 22-SEP-20 03:08:42.636385 +05:30<br>(1 row)<br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">current_date</strong>;<br> current_date <br><em class="markup--em markup--pre-em">--------------</em><br> 22-SEP-20<br>(1 row)<br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> <strong class="markup--strong markup--pre-strong">current_time</strong>;<br>     current_time      <br><em class="markup--em markup--pre-em">-----------------------</em><br> 03:08:53.648466+05:30<br>(1 row)</code></pre><p name="8492" id="8492" class="graf graf--p graf-after--pre">We can also perform a date range query to find rows with values between two time stamps:</p><pre name="92f2" id="92f2" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> datetable(n <strong class="markup--strong markup--pre-strong">int</strong>,n1 <strong class="markup--strong markup--pre-strong">date</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;12-01-1980&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (2,&#39;12-01-2020&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> datetable <strong class="markup--strong markup--pre-strong">values</strong> (3,&#39;12-01-2000&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> datetable <strong class="markup--strong markup--pre-strong">where</strong> n1 between &#39;12-01-1980&#39; <strong class="markup--strong markup--pre-strong">and</strong> &#39;12-01-2000&#39;;<br> n |         n1         <br><em class="markup--em markup--pre-em">---+--------------------</em><br> 1 | 12-JAN-80 00:00:00<br> 3 | 12-JAN-00 00:00:00<br>(2 rows)</code></pre><h3 name="218f" id="218f" class="graf graf--h3 graf-after--pre">33. PostgreSQL function RETURN QUERY result</h3><p name="af8d" id="af8d" class="graf graf--p graf-after--h3">When a PL/pgSQL function is declared to return a SETOF some data type, the return is specified by a <a href="https://www.postgresql.org/docs/12/plpgsql-control-structures.html" data-href="https://www.postgresql.org/docs/12/plpgsql-control-structures.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">RETURN QUERY</a> command:</p><pre name="f09e" id="f09e" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> FUNCTION <strong class="markup--strong markup--pre-strong">get</strong>(<strong class="markup--strong markup--pre-strong">int</strong>) RETURNS SETOF <strong class="markup--strong markup--pre-strong">integer</strong> <strong class="markup--strong markup--pre-strong">AS</strong><br>$BODY$<br><strong class="markup--strong markup--pre-strong">BEGIN</strong><br>    RETURN QUERY <strong class="markup--strong markup--pre-strong">SELECT</strong> age<br>                   <strong class="markup--strong markup--pre-strong">FROM</strong> dummy_table<br>                  <strong class="markup--strong markup--pre-strong">WHERE</strong> age &gt;= $1  ;<br>    RETURN;<br> <strong class="markup--strong markup--pre-strong">END</strong><br>$BODY$<br><strong class="markup--strong markup--pre-strong">LANGUAGE</strong> plpgsql;<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">get</strong>(9);<br> get <br><em class="markup--em markup--pre-em">-----</em><br>  25<br>  35<br>  40<br>  50<br>(4 rows)</code></pre><h3 name="4e37" id="4e37" class="graf graf--h3 graf-after--pre">34. PostgreSQL parallel query performance</h3><p name="1f00" id="1f00" class="graf graf--p graf-after--h3"><a href="https://www.postgresql.org/docs/12/parallel-query.html" data-href="https://www.postgresql.org/docs/12/parallel-query.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Parallel queries</a> in PostgreSQL allow you to finish queries faster by utilizing many CPUs. These GUCs parameters are set in postgresql.conf file:</p><pre name="76eb" id="76eb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><em class="markup--em markup--pre-em">#max_parallel_maintenance_workers = 2   # taken from max_parallel_workers</em><br><em class="markup--em markup--pre-em">#max_parallel_workers_per_gather = 2    # taken from max_parallel_workers</em><br><em class="markup--em markup--pre-em">#parallel_leader_participation = on</em><br><em class="markup--em markup--pre-em">#max_parallel_workers = 8               # maximum number of max_worker_processes that</em><br>                                                           <em class="markup--em markup--pre-em"># can be used in parallel operations</em><br><br><br>postgres=<em class="markup--em markup--pre-em"># create table ty(n int);</em><br>CREATE TABLE<br>postgres=<em class="markup--em markup--pre-em"># insert into ty values (generate_series(1,300000));</em><br>INSERT 0 300000<br><br>postgres=<em class="markup--em markup--pre-em"># analyze ty;</em><br>ANALYZE<br>postgres=<em class="markup--em markup--pre-em"># explain  select * from ty where n&lt;=1;</em><br>                             QUERY PLAN                              <br>---------------------------------------------------------------------<br> Gather  (cost=1000.00..4536.88 rows=30 width=4)<br>   Workers Planned: 1<br>   -&gt;  Parallel Seq Scan <strong class="markup--strong markup--pre-strong">on</strong> ty  (cost=0.00..3533.88 rows=18 width=4)<br>         Filter: (n &lt;= 1)<br>(4 rows)<br><br>postgres=<em class="markup--em markup--pre-em">#</em></code></pre><h3 name="cc40" id="cc40" class="graf graf--h3 graf-after--pre">35. Logical operators in PostgreSQL</h3><p name="535f" id="535f" class="graf graf--p graf-after--h3">There are three basic <a href="https://www.postgresql.org/docs/12/functions-logical.html" data-href="https://www.postgresql.org/docs/12/functions-logical.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">logical operators</a> available in PostgreSQL: AND, OR, and NOT.</p><p name="c1a4" id="c1a4" class="graf graf--p graf-after--p">These operators are used to match conditions in SQL statements—e.g., in WHERE and HAVING clauses.</p><pre name="1646" id="1646" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">AND = <strong class="markup--strong markup--pre-strong">when</strong> both boolean expressions are <strong class="markup--strong markup--pre-strong">true</strong> <strong class="markup--strong markup--pre-strong">then</strong> it will <strong class="markup--strong markup--pre-strong">return</strong> TRUE<br>OR   = <strong class="markup--strong markup--pre-strong">when</strong> any boolean expression <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">true</strong> <strong class="markup--strong markup--pre-strong">then</strong> it will <strong class="markup--strong markup--pre-strong">return</strong> TRUE<br>NOT = reverses the value <strong class="markup--strong markup--pre-strong">of</strong> Boolean operator</code></pre><h3 name="b77e" id="b77e" class="graf graf--h3 graf-after--pre">Some logical operator examples</h3><pre name="d614" id="d614" class="graf graf--pre graf-after--h3">If both expressions are true, then the result is TRUE. postgresql=# select 1=1/1 and 200=2+198 as result_and_operator; result_and_operator --------------------- t (1 row) postgresql=#</pre><pre name="c7c1" id="c7c1" class="graf graf--pre graf-after--pre">If one expression is true and another expression is NULL, then the result is NULL. postgresql=# select 4=4 and null; ?column? ---------- (1 row)<br>If one expression is true and another expression is false, then the result is TRUE. postgres=# select 1=100 OR 2=2; ?column? ---------- t (1 row)</pre><h3 name="0be4" id="0be4" class="graf graf--h3 graf-after--pre">36. Catching duplicate rows in a PostgreSQL table</h3><p name="36f7" id="36f7" class="graf graf--p graf-after--h3">In the following SQL query, there are two records with the value 50:</p><pre name="8851" id="8851" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> age <br><em class="markup--em markup--pre-em">-----</em><br>  25<br>  35<br>  40<br>  50<br>  50<br>(5 rows)</code></pre><p name="ca41" id="ca41" class="graf graf--p graf-after--pre">We can use the following SELECT … HAVING query to find the duplicate rows:</p><pre name="5210" id="5210" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=#  <strong class="markup--strong markup--pre-strong">select</strong> age, <strong class="markup--strong markup--pre-strong">count</strong>(age) <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">group</strong> <strong class="markup--strong markup--pre-strong">by</strong> age <strong class="markup--strong markup--pre-strong">having</strong> <strong class="markup--strong markup--pre-strong">count</strong>(age)&gt;1;<br> age | count <br><em class="markup--em markup--pre-em">-----+-------</em><br>  50 |     2<br>(1 row)</code></pre><h3 name="4e86" id="4e86" class="graf graf--h3 graf-after--pre">37. Enum query in PostgreSQL</h3><p name="151f" id="151f" class="graf graf--p graf-after--h3"><a href="https://www.postgresql.org/docs/12/datatype-enum.html" data-href="https://www.postgresql.org/docs/12/datatype-enum.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Enumerated (enum) types</a> are data types that comprise a static, ordered set of values.</p><pre name="0f3d" id="0f3d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> TYPE mood <strong class="markup--strong markup--pre-strong">AS</strong> ENUM (&#39;sad&#39;, &#39;ok&#39;, &#39;happy&#39;);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> TYPE<br>postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> testi(n <strong class="markup--strong markup--pre-strong">int</strong>, n1 mood);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;happy&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;sad&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> testi <strong class="markup--strong markup--pre-strong">values</strong> (1,&#39;ok&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1</code></pre><p name="5adb" id="5adb" class="graf graf--p graf-after--pre">If the enum has not been specified, it will give an error:</p><pre name="1cc9" id="1cc9" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<strong class="markup--strong markup--pre-strong"># insert into testi values (1,&#39;happyo&#39;);</strong><br>ERROR:  invalid input <strong class="markup--strong markup--pre-strong">value</strong> <strong class="markup--strong markup--pre-strong">for</strong> <strong class="markup--strong markup--pre-strong">enum</strong> mood: &quot;happyo&quot;</code></pre><h3 name="270a" id="270a" class="graf graf--h3 graf-after--pre">38. Pivot query in PostgreSQL</h3><p name="ddb4" id="ddb4" class="graf graf--p graf-after--h3">A pivot table is a useful way to analyze large quantities of data by organizing it into a more manageable format.</p><pre name="c122" id="c122" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0"><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> newtb(id SERIAL, rowid <strong class="markup--strong markup--pre-strong">varchar</strong>(10), attri <strong class="markup--strong markup--pre-strong">varchar</strong>(10), val <strong class="markup--strong markup--pre-strong">varchar</strong>(10));<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a1&#39;,&#39;v1&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a2&#39;,&#39;v2&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a3&#39;,&#39;v3&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t1&#39;,&#39;a4&#39;,&#39;v4&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a1&#39;,&#39;v5&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a2&#39;,&#39;v6&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a3&#39;,&#39;v7&#39;);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> <strong class="markup--strong markup--pre-strong">INTO</strong> newtb(rowid, attri, val) <strong class="markup--strong markup--pre-strong">values</strong>(&#39;t2&#39;,&#39;a4&#39;,&#39;v8&#39;);</code></pre><p name="219e" id="219e" class="graf graf--p graf-after--pre">To create a pivot table you need to install the <a href="https://www.postgresql.org/docs/12/tablefunc.html" data-href="https://www.postgresql.org/docs/12/tablefunc.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">tablefunc extension</a>:</p><pre name="6ec7" id="6ec7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> extension tablefunc;<br><strong class="markup--strong markup--pre-strong">CREATE</strong> EXTENSION<br><br><strong class="markup--strong markup--pre-strong">Select</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> crosstab(<br>  &#39;select rowid, attri, val<br>   from newtb<br>   where attri = &#39;&#39;a2&#39;&#39; or attri = &#39;&#39;a3&#39;&#39;<br>   order by 1,2&#39;)<br><strong class="markup--strong markup--pre-strong">AS</strong> newtb(row_name <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_1 <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_2 <strong class="markup--strong markup--pre-strong">varchar</strong>(10), category_3 <strong class="markup--strong markup--pre-strong">varchar</strong>(10));<br> row_name | category_1 | category_2 | category_3 <br><em class="markup--em markup--pre-em">----------+------------+------------+--------------------------</em><br>   t1       |              v2        |            v3    | <br>   t2       |             v6         |             v7   | <br>(2 rows)</code></pre><h3 name="d1aa" id="d1aa" class="graf graf--h3 graf-after--pre">39. SELF JOIN query in PostgreSQL</h3><p name="209d" id="209d" class="graf graf--p graf-after--h3">When we join a table against itself, this is called a SELF JOIN. This can be done using INNER JOIN or LEFT JOIN. SELF JOINs are useful when comparing the columns of rows within the same table:</p><pre name="4acb" id="4acb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">create</strong> <strong class="markup--strong markup--pre-strong">table</strong> emp1(emp_id <strong class="markup--strong markup--pre-strong">int</strong>, firstname <strong class="markup--strong markup--pre-strong">char</strong>(10), lastname <strong class="markup--strong markup--pre-strong">char</strong>(10) , manager_id <strong class="markup--strong markup--pre-strong">int</strong>);<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br>postgres=# <br>postgres=# <br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(1,&#39;ABC&#39;,&#39;XYZ&#39;,<strong class="markup--strong markup--pre-strong">NULL</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(2,&#39;TYU&#39;,&#39;BGV&#39;,1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(3,&#39;TEU&#39;,&#39;ZZV&#39;,1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(4,&#39;REU&#39;,&#39;AZV&#39;,2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(5,&#39;QREU&#39;,&#39;WZV&#39;,2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> emp1 <strong class="markup--strong markup--pre-strong">values</strong>(6,&#39;DREU&#39;,&#39;QZV&#39;,3);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br><br>postgres=# <strong class="markup--strong markup--pre-strong">select</strong> a.firstname,b.lastname <strong class="markup--strong markup--pre-strong">from</strong> emp1 a <strong class="markup--strong markup--pre-strong">inner</strong> <strong class="markup--strong markup--pre-strong">join</strong> emp1 b <strong class="markup--strong markup--pre-strong">on</strong> a.emp_id=b.manager_id <strong class="markup--strong markup--pre-strong">order</strong> <strong class="markup--strong markup--pre-strong">by</strong> 1 ;<br> firstname  |  lastname  <br><em class="markup--em markup--pre-em">------------+------------</em><br> ABC        | ZZV       <br> ABC        | BGV       <br> TEU        | QZV       <br> TYU        | WZV       <br> TYU        | AZV       <br>(5 rows)<br><br>postgres=#</code></pre><h3 name="8799" id="8799" class="graf graf--h3 graf-after--pre">40. Parent-child recursive query in PostgreSQL</h3><p name="7062" id="7062" class="graf graf--p graf-after--h3">With the help of <a href="https://www.postgresql.org/docs/12/queries-with.html" data-href="https://www.postgresql.org/docs/12/queries-with.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">common table expressions</a> (CTE) we can perform parent-child recursive queries:</p><pre name="e248" id="e248" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong> recu_pc (<br> id SERIAL <strong class="markup--strong markup--pre-strong">PRIMARY</strong> <strong class="markup--strong markup--pre-strong">KEY</strong>,<br> name <strong class="markup--strong markup--pre-strong">varchar</strong>(10) <strong class="markup--strong markup--pre-strong">NOT</strong> <strong class="markup--strong markup--pre-strong">NULL</strong>,<br> parent_id <strong class="markup--strong markup--pre-strong">integer</strong> );<br><strong class="markup--strong markup--pre-strong">CREATE</strong> <strong class="markup--strong markup--pre-strong">TABLE</strong><br> <br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (1, &#39;Grandmother&#39;, <strong class="markup--strong markup--pre-strong">NULL</strong>);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (2, &#39;mother&#39;, 1);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br>postgres=# <strong class="markup--strong markup--pre-strong">insert</strong> <strong class="markup--strong markup--pre-strong">into</strong> recu_pc <strong class="markup--strong markup--pre-strong">values</strong> (3, &#39;daughter&#39;, 2);<br><strong class="markup--strong markup--pre-strong">INSERT</strong> 0 1<br><br> <br>postgres=# <strong class="markup--strong markup--pre-strong">WITH</strong> RECURSIVE rec_q (id) <strong class="markup--strong markup--pre-strong">as</strong><br>(          <br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> recu_pc.id, recu_pc.name <strong class="markup--strong markup--pre-strong">from</strong> recu_pc <strong class="markup--strong markup--pre-strong">where</strong> name=&#39;mother&#39;<br>  <strong class="markup--strong markup--pre-strong">UNION</strong> <strong class="markup--strong markup--pre-strong">ALL</strong><br>  <strong class="markup--strong markup--pre-strong">SELECT</strong> recu_pc.id, recu_pc.name <strong class="markup--strong markup--pre-strong">from</strong> rec_q, recu_pc <strong class="markup--strong markup--pre-strong">where</strong> recu_pc.parent_id = rec_q.id<br>  )<br><strong class="markup--strong markup--pre-strong">SELECT</strong> *<br><strong class="markup--strong markup--pre-strong">FROM</strong> rec_q;<br> id |   name   <br><em class="markup--em markup--pre-em">----+----------</em><br>  2 | mother<br>  3 | daughter<br>(2 rows)</code></pre><h3 name="f973" id="f973" class="graf graf--h3 graf-after--pre">41. Defining a variable in a query in PostgreSQL</h3><p name="55d5" id="55d5" class="graf graf--p graf-after--h3">Using an <a href="https://www.postgresql.org/docs/12/sql-do.html" data-href="https://www.postgresql.org/docs/12/sql-do.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">anonymous block</a>, we can define a variable that can be passed to in a query:</p><pre name="b4af" id="b4af" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">do</strong> <br>$$<br><strong class="markup--strong markup--pre-strong">declare</strong> <br>a <strong class="markup--strong markup--pre-strong">int</strong>;<br><strong class="markup--strong markup--pre-strong">begin</strong> <br><strong class="markup--strong markup--pre-strong">select</strong> age <strong class="markup--strong markup--pre-strong">into</strong> a <strong class="markup--strong markup--pre-strong">from</strong> dummy_table  <br><strong class="markup--strong markup--pre-strong">where</strong> name =&#39;XYZ&#39;;<br>raise notice &#39;%&#39;,a; <br><strong class="markup--strong markup--pre-strong">end</strong>;<br>$$;<br>NOTICE:  25<br><strong class="markup--strong markup--pre-strong">DO</strong></code></pre><h3 name="9045" id="9045" class="graf graf--h3 graf-after--pre">42. PREPARE statement in PostgreSQL</h3><p name="6a4d" id="6a4d" class="graf graf--p graf-after--h3">A prepared statement is used to optimize performance. When the <a href="https://www.postgresql.org/docs/12/sql-prepare.html" data-href="https://www.postgresql.org/docs/12/sql-prepare.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">PREPARE statement</a> is executed, it is not only parsed but analyzed too, and when we fire the EXECUTE command the prepared statement is planned and executed.</p><p name="b062" id="b062" class="graf graf--p graf-after--p">Prepared statements can accept parameters.</p><pre name="922a" id="922a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=<strong class="markup--strong markup--pre-strong"># prepare test(int) as </strong><br><strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age=$1;<br>PREPARE<br> <br>postgres=<strong class="markup--strong markup--pre-strong"># execute test(50);</strong><br> name |  address   | age <br>------+------------+---------<br> PQR  | location-D |  50<br> CXC | 1                |  50<br>(2 rows)</code></pre><h3 name="5583" id="5583" class="graf graf--h3 graf-after--pre">43. Checking NULL values in PostgreSQL</h3><p name="79ae" id="79ae" class="graf graf--p graf-after--h3">To Identify or select rows that have NULL values, the <a href="https://www.postgresql.org/docs/12/functions-comparison.html" data-href="https://www.postgresql.org/docs/12/functions-comparison.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">IS NULL</a> condition can be used in the WHERE clause.</p><pre name="03eb" id="03eb" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> * <strong class="markup--strong markup--pre-strong">from</strong> dummy_table;<br> name |  address   | age <br><em class="markup--em markup--pre-em">------+------------+-----</em><br> XYZ  | location-A |  25<br> ABC  | location-B |  35<br> DEF  | location-C |  40<br> PQR  | location-D |  54<br> PQR  | location-D |    <br>(5 rows)</code></pre><p name="3187" id="3187" class="graf graf--p graf-after--pre">Identifying null values in ‘age’ column:</p><pre name="8219" id="8219" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code u-paddingRight0 u-marginRight0">postgres=# <strong class="markup--strong markup--pre-strong">select</strong> name <strong class="markup--strong markup--pre-strong">from</strong> dummy_table <strong class="markup--strong markup--pre-strong">where</strong> age <strong class="markup--strong markup--pre-strong">is</strong> <strong class="markup--strong markup--pre-strong">null</strong>;<br> name <br><em class="markup--em markup--pre-em">------</em><br> PQR<br>(1 row)</code></pre><h3 name="6d65" id="6d65" class="graf graf--h3 graf-after--pre">Sources:</h3><ol class="postList"><li name="0c44" id="0c44" class="graf graf--li graf-after--h3">) <a href="https://careerkarma.com/blog/sql-deep-dives/" data-href="https://careerkarma.com/blog/sql-deep-dives/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://careerkarma.com/blog/sql-deep-dives/</a></li><li name="b85e" id="b85e" class="graf graf--li graf-after--li"><a href="https://www.postgresql.org/docs/13/app-psql.html" data-href="https://www.postgresql.org/docs/13/app-psql.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">https://www.postgresql.org/docs/13/app-psql.html</a></li></ol><p name="d861" id="d861" class="graf graf--p graf-after--li">Learn More:</p><div name="2c42" id="2c42" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://bgoonz-blog.netlify.app/" data-href="https://bgoonz-blog.netlify.app/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://bgoonz-blog.netlify.app/"><strong class="markup--strong markup--mixtapeEmbed-strong">Web-Dev-Hub</strong><br><em class="markup--em markup--mixtapeEmbed-em">Memoization, Tabulation, and Sorting Algorithms by Example Why is looking at runtime not a reliable method of…</em>bgoonz-blog.netlify.app</a><a href="https://bgoonz-blog.netlify.app/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a2f1abe4ed6a87b0b90d28e55f930d20" data-thumbnail-img-id="0*SPECmcEKvW7DgfYQ" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SPECmcEKvW7DgfYQ);"></a></div><h3 name="a157" id="a157" class="graf graf--h3 graf-after--mixtapeEmbed">Further Examples / Readings:</h3></div><div class="section-inner sectionLayout--outsetColumn"><figure name="0c47" id="0c47" class="graf graf--figure graf--iframe graf--layoutOutsetCenter graf-after--h3"><iframe src="https://replit.com/@bgoonz/SQLite-starter-Template-Jam?lite=true&amp;amp%3Breferrer=https%3A%2F%2Fbryanguner.medium.com&amp;lite=true" width="1192" height="894" frameborder="0" scrolling="no"></iframe></figure><figure name="eb2c" id="eb2c" class="graf graf--figure graf--iframe graf--layoutOutsetCenter graf-after--figure"><iframe src="https://replit.com/@bgoonz/express-sqlite-app?lite=true&amp;amp%3Breferrer=https%3A%2F%2Fbryanguner.medium.com&amp;lite=true" width="1192" height="894" frameborder="0" scrolling="no"></iframe></figure><figure name="2bee" id="2bee" class="graf graf--figure graf--iframe graf--layoutOutsetCenter graf-after--figure"><iframe src="https://replit.com/@bgoonz/Database-Prac?lite=true&amp;amp%3Breferrer=https%3A%2F%2Fbryanguner.medium.com&amp;lite=true" width="1192" height="894" frameborder="0" scrolling="no"></iframe></figure></div><div class="section-inner sectionLayout--insetColumn"><figure name="69ec" id="69ec" class="graf graf--figure graf--iframe graf-after--figure graf--trailing"><script src="https://gist.github.com/bgoonz/9334834b01a25bfe00dfa97cd86c5c19.js"></script></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@bryanguner" class="p-author h-card">Bryan Guner</a> on <a href="https://medium.com/p/19fba3e37110"><time class="dt-published" datetime="2021-07-14T06:28:09.243Z">July 14, 2021</time></a>.</p><p><a href="https://medium.com/@bryanguner/postgresql-in-43-commands-or-less-19fba3e37110" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 10, 2021.</p></footer></article></body></html>