<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Express-Routing</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Express-Routing</h1>
</header>
<section data-field="subtitle" class="p-summary">
Note: To read this in a rendered view, open your VS Code Command Palate
(using Control+Shift+P on Windows, Command+Shift+P on macOS)
</section>
<section data-field="body" class="e-content">
<section name="a250" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1174" id="1174" class="graf graf--h3 graf--leading graf--title">Express-Routing</h3><h4 name="4ddf" id="4ddf" class="graf graf--h4 graf-after--h3 graf--subtitle"><strong class="markup--strong markup--h4-strong">Note:</strong> To read this in a rendered view, open your VS Code Command Palate<br>(using Control+Shift+P on Windows, Command+Shift+P on macOS) </h4><p name="bc46" id="bc46" class="graf graf--p graf--empty graf-after--h4"><br></p><h4 name="b8f9" id="b8f9" class="graf graf--h4 graf-after--p"><br><br></h4><p name="2cbe" id="2cbe" class="graf graf--p graf-after--h4">Create an Express application. </p><ul class="postList"><li name="216c" id="216c" class="graf graf--li graf-after--p">Has a page that shows a list of people</li><li name="fc00" id="fc00" class="graf graf--li graf-after--li">Has a page that allows you to add a person</li><li name="b702" id="b702" class="graf graf--li graf-after--li">Is protected from Cross-Site Request Forgeries</li></ul><p name="eba1" id="eba1" class="graf graf--p graf-after--li">In the <strong class="markup--strong markup--p-strong">images</strong> directory, you will find</p><ul class="postList"><li name="b45d" id="b45d" class="graf graf--li graf-after--p">A screenshot of the person listing page</li><li name="39bc" id="39bc" class="graf graf--li graf-after--li">A screenshot of the person creation form</li></ul><p name="0f04" id="0f04" class="graf graf--p graf-after--li">The screenshots show you what is expected from a <em class="markup--em markup--p-em">structure</em> standpoint. They<br>are meant to be guides. The tests will <em class="markup--em markup--p-em">not</em> make any assertions about the<br>styling of your pages, merely the structure of the pages and the data presented<br>on them.</p><p name="3337" id="3337" class="graf graf--p graf-after--p">Use the technologies you have used up to this point. They are all installed in<br>the <strong class="markup--strong markup--p-strong">package.json</strong> for your convenience.</p><ul class="postList"><li name="e52d" id="e52d" class="graf graf--li graf-after--p">Express.js</li><li name="ab8b" id="ab8b" class="graf graf--li graf-after--li">pg (the library to connect to PostgreSQL), Sequelize, and Sequelize CLI</li><li name="8b4e" id="8b4e" class="graf graf--li graf-after--li">CSURF middleware</li><li name="b9f8" id="b9f8" class="graf graf--li graf-after--li">Pug.js</li><li name="b4d2" id="b4d2" class="graf graf--li graf-after--li">cookie-parser middleware</li><li name="52f9" id="52f9" class="graf graf--li graf-after--li">body-parser middleware</li><li name="5536" id="5536" class="graf graf--li graf-after--li">nodemon (for development purposes)</li></ul><p name="6d98" id="6d98" class="graf graf--p graf-after--li">A <strong class="markup--strong markup--p-strong">package.json</strong> file already exists with the dependencies. Please run <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">npm install</strong></code> to install those before doing your development and running your tests.<br>Do not remove any dependencies already listed in the <strong class="markup--strong markup--p-strong">package.json</strong>.</p><h3 name="b9ea" id="b9ea" class="graf graf--h3 graf-after--p">Running the application</h3><p name="acf2" id="acf2" class="graf graf--p graf-after--h3">You can run your application in “dev” mode. The <strong class="markup--strong markup--p-strong">nodemon</strong> package is installed<br>and runnable from <code class="markup--code markup--p-code">npm run dev</code>.</p><h3 name="c385" id="c385" class="graf graf--h3 graf-after--p">Running the tests</h3><p name="c055" id="c055" class="graf graf--p graf-after--h3">This is “black-box testing”. The tests will <em class="markup--em markup--p-em">only</em> use your Express application.<br>It will not make connections to the database or directly test your route<br>handlers. They will merely make HTTP requests of your Express app and analyze<br>the responses.</p><p name="edb5" id="edb5" class="graf graf--p graf-after--p">To ease your development, tests will run against your <strong class="markup--strong markup--p-strong">development</strong> database<br>and <em class="markup--em markup--p-em">not</em> the test database.</p><p name="6865" id="6865" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">You</strong> will be responsible for creating, migrating, and seeding the data in<br>your development database.</p><p name="d10f" id="d10f" class="graf graf--p graf-after--p">Run your tests with <code class="markup--code markup--p-code">npm test</code>. You can run <code class="markup--code markup--p-code">npm test test/test-file-name.js</code><br>to run the tests for a specific part of the assessment.</p><ul class="postList"><li name="5f97" id="5f97" class="graf graf--li graf-after--p">Example: To only run the test <code class="markup--code markup--li-code">01-form-page.js</code> do,<br><code class="markup--code markup--li-code">npm test test/01-form-page.js</code></li></ul><p name="620a" id="620a" class="graf graf--p graf-after--li">If you get tired of seeing all of the Sequelize failures, you can try running:</p><pre name="8388" id="8388" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">npm test 2&gt; /dev/null</code></pre><p name="3ccc" id="3ccc" class="graf graf--p graf-after--pre">That should redirect the annoying messages into oblivion but leave the<br>mocha output available for you to read. This may prevent you from seeing other<br>errors, though, so make sure to run it without the <code class="markup--code markup--p-code">2&gt; /dev/null</code> if you&#39;re<br>trying to get a test to pass and need to see error output.</p><h3 name="985c" id="985c" class="graf graf--h3 graf-after--p">App Requirements</h3><p name="f25a" id="f25a" class="graf graf--p graf-after--h3">These are the requirements for the application. Follow them closely. The tests<br>will attempt to read data from your rendered HTML.</p><p name="fba4" id="fba4" class="graf graf--p graf-after--p">Read all of the requirements. Determine the data needed to include in your data<br>model.</p><p name="c28d" id="c28d" class="graf graf--p graf-after--p">Please use port 8081 for your Express.js server.</p><h3 name="e861" id="e861" class="graf graf--h3 graf-after--p">The database</h3><p name="ec27" id="ec27" class="graf graf--p graf-after--h3">Create a database user with <code class="markup--code markup--p-code">CREATEDB</code> priveleges:</p><ul class="postList"><li name="96a3" id="96a3" class="graf graf--li graf-after--p">The login username that you must use is “express_practice_app”</li><li name="6e88" id="6e88" class="graf graf--li graf-after--li">The login password that you must use is “EzB5Dxo2dabnQBF8”</li></ul><p name="532f" id="532f" class="graf graf--p graf-after--li">Initialize Sequelize in your assessment and use the following configuration in<br>your <code class="markup--code markup--p-code">config/config.json</code> file:</p><pre name="6dbc" id="6dbc" class="graf graf--pre graf-after--p">{<br>  &quot;development&quot;: {<br>    &quot;username&quot;: &quot;express_practice_app&quot;,<br>    &quot;password&quot;: &quot;EzB5Dxo2dabnQBF8&quot;,<br>    &quot;database&quot;: &quot;express_practice_development&quot;,<br>    &quot;host&quot;: &quot;127.0.0.1&quot;,<br>    &quot;dialect&quot;: &quot;postgres&quot;,<br>    &quot;seederStorage&quot;: &quot;sequelize&quot;,<br>    &quot;logging&quot;: false<br>  }<br>}</pre><p name="7143" id="7143" class="graf graf--p graf-after--pre">Remove <code class="markup--code markup--p-code">logging: false</code> if you want to see SQL output in your terminal when<br>running tests with <code class="markup--code markup--p-code">npm test</code>.</p><p name="f25b" id="f25b" class="graf graf--p graf-after--p">Create the <code class="markup--code markup--p-code">development</code> database with those configurations.</p><p name="921c" id="921c" class="graf graf--p graf-after--p">For this assessment, the tests will be using your <code class="markup--code markup--p-code">development</code> database<br>configuration defined in the <code class="markup--code markup--p-code">config.json</code> file. <strong class="markup--strong markup--p-strong">The tests will not be<br>testing your database explicitly, but test specs DO rely on you setting up the<br>database AND database constraints properly.</strong></p><p name="3340" id="3340" class="graf graf--p graf-after--p">You will need to generate and run the migrations, models, and seeders. There is<br>no need to run <code class="markup--code markup--p-code">npm test</code> until after doing this.</p><h3 name="c6aa" id="c6aa" class="graf graf--h3 graf-after--p">The data model</h3><p name="f59e" id="f59e" class="graf graf--p graf-after--h3">You will need to store “People” data and “HairColor” data.</p><p name="e255" id="e255" class="graf graf--p graf-after--p">Generate a model (and migration) for the “HairColor” model with the attributes:</p><p name="b7ba" id="b7ba" class="graf graf--p graf-after--p">Attribute nameAttribute typeConstraintscolorstringunique, not nullable</p><ul class="postList"><li name="cda4" id="cda4" class="graf graf--li graf-after--p">the “color” column will hold values up to 20 characters in length and<br>will not allow <code class="markup--code markup--li-code">NULL</code>s</li></ul><p name="1e9d" id="1e9d" class="graf graf--p graf-after--li">Generate a model (and migration) for the “Person” model with the attributes:</p><p name="1743" id="1743" class="graf graf--p graf-after--p">Attribute nameAttribute typeConstraintsfirstNamestringnot nullablelastNamestringnot nullableageintegerbiographytexthairColorIdintegernot nullable, references HairColors</p><p name="6464" id="6464" class="graf graf--p graf-after--p">Configure the migration so that:</p><ul class="postList"><li name="7b0d" id="7b0d" class="graf graf--li graf-after--p">the “firstName” column will hold values up to 50 characters in length and<br>will not allow <code class="markup--code markup--li-code">NULL</code>s</li><li name="c44e" id="c44e" class="graf graf--li graf-after--li">the “lastName” column will hold values up to 50 characters in length and<br>will not allow <code class="markup--code markup--li-code">NULL</code>s</li><li name="e6f2" id="e6f2" class="graf graf--li graf-after--li">the “hairColorId” will not allow <code class="markup--code markup--li-code">NULL</code>s and references the &quot;HairColors&quot;<br>table</li></ul><p name="d59b" id="d59b" class="graf graf--p graf-after--li">Create a seeder file for <code class="markup--code markup--p-code">HairColors</code>:</p><pre name="c3f4" id="c3f4" class="graf graf--pre graf-after--p">{ color: &quot;Auburn&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39;},<br>{ color: &quot;Black&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },<br>{ color: &quot;Blonde&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },<br>{ color: &quot;Brown&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },<br>{ color: &quot;Other&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },<br>{ color: &quot;Red&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },<br>{ color: &quot;White&quot;, createdAt: &#39;2019-04-12&#39;, updatedAt: &#39;2019-04-12&#39; },</pre><p name="b769" id="b769" class="graf graf--p graf-after--pre">If you set up the seeder correctly, the <code class="markup--code markup--p-code">HairColors</code> table should have the<br>following pre-defined data in it:</p><p name="dc5a" id="dc5a" class="graf graf--p graf-after--p">colorAuburnBlackBlondeBrownOtherRedWhite</p><p name="c177" id="c177" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">NOTE:</strong> All of the data constraints for this assessment can be handled by the<br>database with the <code class="markup--code markup--p-code">allowNull</code> and <code class="markup--code markup--p-code">unique</code> flags in your migrations. You <strong class="markup--strong markup--p-strong">do<br>not</strong> need to use form validations in this project. They are good to have, in<br>real applications, but can require too much time for you to integrate them into<br>this project. Again, you <strong class="markup--strong markup--p-strong">do not</strong> need to use a form validator, just use<br>database constraints and let the errors turn into 500 status codes by Express.</p><p name="05d4" id="05d4" class="graf graf--p graf-after--p">Make sure to make the appropriate associations.</p><p name="14b0" id="14b0" class="graf graf--p graf-after--p">After you’ve generated your models, migrations, and seeder files, don’t forget<br>to migrate and seed your database with the appropriate Sequelize CLI commands.</p><h3 name="2420" id="2420" class="graf graf--h3 graf-after--p">Your main file</h3><p name="08ca" id="08ca" class="graf graf--p graf-after--h3">You must use the <strong class="markup--strong markup--p-strong">app.js</strong> file to create and configure your Express<br>application. You must store the instance of your Express.js application in a<br>variable named “app”. That is what is exported at the bottom of the <strong class="markup--strong markup--p-strong">app.js</strong><br>file.</p><p name="0bd7" id="0bd7" class="graf graf--p graf-after--p">Set up your CSRF middleware to use cookies.</p><h3 name="b1dd" id="b1dd" class="graf graf--h3 graf-after--p">The route “GET /new-person”</h3><p name="c9d3" id="c9d3" class="graf graf--p graf-after--h3">This page shows a form in which a visitor can add a new person. The form must<br>have</p><ul class="postList"><li name="4869" id="4869" class="graf graf--li graf-after--p">a method of “post”</li><li name="1861" id="1861" class="graf graf--li graf-after--li">an action of “/new-person”</li></ul><p name="e5c6" id="e5c6" class="graf graf--p graf-after--li">In the form, you should have these inputs with the provided name:</p><p name="4305" id="4305" class="graf graf--p graf-after--p">Field HTML nameField typeConstraintsDefault valuesfirstNamesingle-line textrequiredlastNamesingle-line textrequiredagenumberbiographymulti-line texthairColorIddropdownrequiredOne of the pre-defined hair colors_csrfhiddenThe value provided by the CSURF middleware</p><p name="d424" id="d424" class="graf graf--p graf-after--p">You should also have a submit button.</p><p name="090b" id="090b" class="graf graf--p graf-after--p">Please refer to the screenshot below:</p><h3 name="0183" id="0183" class="graf graf--h3 graf-after--p">The route “POST /new-person”</h3><p name="a075" id="a075" class="graf graf--p graf-after--h3">The post handler should validate the data from the HTTP request. If everything<br>is fine, then it should create a new person and redirect to the route “/”.</p><p name="8f18" id="8f18" class="graf graf--p graf-after--p">Remember, all of the data constraints for this assessment can be handled by the<br>database with the <code class="markup--code markup--p-code">allowNull</code> and <code class="markup--code markup--p-code">unique</code> flags in your migrations. You <strong class="markup--strong markup--p-strong">do<br>not</strong> need to use form validations in this project. They are good to have, in<br>real applications, but can require too much time for you to integrate them into<br>this project. Again, you <strong class="markup--strong markup--p-strong">do not</strong> need to use a form validator, just use<br>database constraints and let the errors turn into 500 status codes by Express.</p><p name="a35a" id="a35a" class="graf graf--p graf-after--p">If the data does not pass validation, then no new record should be created. It<br>is ok to just let Express return an error code of 500 in this case. <strong class="markup--strong markup--p-strong">Note</strong>:<br>you would not do this in a real application.</p><h3 name="9631" id="9631" class="graf graf--h3 graf-after--p">The route “GET /”</h3><p name="431c" id="431c" class="graf graf--p graf-after--h3">When someone accesses your application, they should see a list of people that<br>are stored in your database. The list should contain:</p><ul class="postList"><li name="8be4" id="8be4" class="graf graf--li graf-after--p">The person’s first name</li><li name="30c2" id="30c2" class="graf graf--li graf-after--li">The person’s last name</li><li name="c4ee" id="c4ee" class="graf graf--li graf-after--li">The person’s age</li><li name="392d" id="392d" class="graf graf--li graf-after--li">A short biography</li><li name="15a9" id="15a9" class="graf graf--li graf-after--li">Their hair color</li></ul><p name="d095" id="d095" class="graf graf--p graf-after--li">Please refer to the screenshot below:</p><p name="6f71" id="6f71" class="graf graf--p graf-after--p">To create a table in a Pug.js template, you’ll use something like the following<br>code. You probably already know this, but it’s included for your reference.</p><pre name="cb2a" id="cb2a" class="graf graf--pre graf-after--p">table<br>  thead<br>    tr<br>      th Header 1<br>      th Header 2<br>  tbody<br>    each thing in things<br>      tr<br>        td= thing.property1<br>        td= thing.property2</pre><p name="7ed9" id="7ed9" class="graf graf--p graf-after--pre">The tests will use a regular expression to determine if each piece of data is<br>wrapped with TD tags. For example, to test for the “Auburn”<br>value appearing in the HTML of the page, the tests would use the following<br>regular expression.</p><pre name="648f" id="648f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">&lt;td[^&gt;]*&gt;\s*Auburn\s*&lt;/td&gt;</code></pre><p name="6fed" id="6fed" class="graf graf--p graf-after--pre">The regular expression will ignore any attributes that you put on the table data<br>tag as well as any white space around the entry for the data value.</p><p name="f1c0" id="f1c0" class="graf graf--p graf-after--p graf--trailing">Again, the styling is not important to the tests.</p></div></div></section>
</section>
<footer><p><a href="https://medium.com/p/40972026781f">View original.</a></p><p>Exported from <a href="https://medium.com">Medium</a> on August 10, 2021.</p></footer></article></body></html>